(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.OPL3=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){(function(Buffer){var extend=_dereq_("extend");function DRO(opl){this.opl=opl}module.exports=DRO;extend(DRO.prototype,{hardwareType:["OPL2","Dual OPL2","OPL3"],load:function(buffer){var header=new Buffer(buffer.buffer).slice(0,8).toString();if(header!="DBRAWOPL")throw new Error('Buffer is not a "DOSBox Raw OPL" file');var buffer=this.data=new DataView(buffer.buffer);this.version="v"+buffer.getUint16(8,true)+"."+buffer.getUint16(10,true);this.size=buffer.getUint32(12,true);this.length=buffer.getUint32(16,true);this.hardware=this.hardwareType[buffer.getUint8(20)];this.dataFormat=buffer.getUint8(21);this.compression=buffer.getUint8(22);this.shortDelay=buffer.getUint8(23);this.longDelay=buffer.getUint8(24);this.codemapSize=buffer.getUint8(25);this.position=26;this.codemap=[];for(var i=0;i<this.codemapSize;i++){this.codemap[i]=buffer.getUint8(this.position++)}this.start=this.position},update:function(){this.delay=0;while(!this.delay&&this.position<this.data.byteLength){var index=this.data.getUint8(this.position);var reg=this.codemap[index];if(index&128){reg=256+this.codemap[index&127]}if(this.position+1>=this.data.byteLength){return false}var value=this.data.getUint8(this.position+1);this.position+=2;if(index==this.shortDelay){this.delay=value+1;return true}else if(index==this.longDelay){this.delay=value+1<<8;return true}else if(typeof reg=="number"){this.midi_write_adlib(reg,value)}else throw Error("Unknown index: "+index)}return false},rewind:function(){this.position=this.start},refresh:function(){return this.delay/8*1/120},midi_write_adlib:function(r,v){var a=0;if(r>=256){a=1;r-=256}this.opl.write(a,r,v)}})}).call(this,_dereq_("buffer").Buffer)},{buffer:16,extend:21}],2:[function(_dereq_,module,exports){module.exports={header:"#OPL_II#",instruments:[{name:"Acoustic Grand Piano",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:240,modulatorSustain:243,modulatorWaveform:1,modulatorKey:64,modulatorOutput:20,feedback:10,carrierTremolo:48,carrierAttack:241,carrierSustain:244,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Bright Acoustic Piano",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:240,modulatorSustain:243,modulatorWaveform:0,modulatorKey:64,modulatorOutput:18,feedback:10,carrierTremolo:48,carrierAttack:241,carrierSustain:244,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Electric Grand Piano",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:225,modulatorSustain:243,modulatorWaveform:1,modulatorKey:64,modulatorOutput:14,feedback:8,carrierTremolo:48,carrierAttack:241,carrierSustain:244,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:17,modulatorAttack:232,modulatorSustain:21,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:1,carrierTremolo:18,carrierAttack:247,carrierSustain:20,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Honky-tonk Piano",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:130,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:241,modulatorSustain:83,modulatorWaveform:1,modulatorKey:64,modulatorOutput:15,feedback:6,carrierTremolo:16,carrierAttack:209,carrierSustain:244,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:17,modulatorAttack:241,modulatorSustain:83,modulatorWaveform:0,modulatorKey:64,modulatorOutput:15,feedback:6,carrierTremolo:17,carrierAttack:209,carrierSustain:244,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Rhodes Paino",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:33,modulatorAttack:241,modulatorSustain:81,modulatorWaveform:0,modulatorKey:64,modulatorOutput:38,feedback:6,carrierTremolo:49,carrierAttack:210,carrierSustain:229,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Chorused Piano",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:241,modulatorSustain:230,modulatorWaveform:0,modulatorKey:64,modulatorOutput:17,feedback:6,carrierTremolo:176,carrierAttack:241,carrierSustain:229,carrierWaveform:0,carrierKey:64,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:18,modulatorAttack:242,modulatorSustain:121,modulatorWaveform:0,modulatorKey:64,modulatorOutput:3,feedback:9,carrierTremolo:16,carrierAttack:241,carrierSustain:153,carrierWaveform:0,carrierKey:64,carrierOutput:0,baseNoteOffset:0}]},{name:"Harpsichord",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:242,modulatorSustain:1,modulatorWaveform:2,modulatorKey:128,modulatorOutput:7,feedback:6,carrierTremolo:48,carrierAttack:193,carrierSustain:244,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Clavinet",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:144,modulatorAttack:161,modulatorSustain:98,modulatorWaveform:1,modulatorKey:128,modulatorOutput:14,feedback:12,carrierTremolo:16,carrierAttack:145,carrierSustain:167,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Celesta",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:40,modulatorAttack:242,modulatorSustain:100,modulatorWaveform:1,modulatorKey:64,modulatorOutput:15,feedback:8,carrierTremolo:49,carrierAttack:242,carrierSustain:228,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Glockenspiel",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:19,modulatorAttack:145,modulatorSustain:17,modulatorWaveform:0,modulatorKey:0,modulatorOutput:14,feedback:9,carrierTremolo:20,carrierAttack:125,carrierSustain:52,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Music Box",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:178,modulatorAttack:246,modulatorSustain:65,modulatorWaveform:0,modulatorKey:0,modulatorOutput:15,feedback:0,carrierTremolo:144,carrierAttack:210,carrierSustain:146,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Vibraphone",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:241,modulatorSustain:243,modulatorWaveform:0,modulatorKey:0,modulatorOutput:2,feedback:1,carrierTremolo:242,carrierAttack:241,carrierSustain:244,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Marimba",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:128,modulatorAttack:121,modulatorSustain:21,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:1,carrierTremolo:131,carrierAttack:248,carrierSustain:117,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Xylophone",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:20,modulatorAttack:246,modulatorSustain:147,modulatorWaveform:0,modulatorKey:0,modulatorOutput:31,feedback:8,carrierTremolo:16,carrierAttack:246,carrierSustain:83,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Tubular-bell",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:129,modulatorAttack:182,modulatorSustain:19,modulatorWaveform:1,modulatorKey:128,modulatorOutput:25,feedback:10,carrierTremolo:2,carrierAttack:255,carrierSustain:19,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Dulcimer",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:145,modulatorSustain:17,modulatorWaveform:0,modulatorKey:64,modulatorOutput:7,feedback:8,carrierTremolo:17,carrierAttack:82,carrierSustain:83,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Hammond Organ",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:177,modulatorSustain:22,modulatorWaveform:0,modulatorKey:128,modulatorOutput:8,feedback:7,carrierTremolo:97,carrierAttack:209,carrierSustain:23,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Percussive Organ",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:241,modulatorSustain:5,modulatorWaveform:1,modulatorKey:0,modulatorOutput:0,feedback:7,carrierTremolo:148,carrierAttack:244,carrierSustain:54,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Rock Organ",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:138,fixedNote:0,voices:[{modulatorTremolo:226,modulatorAttack:242,modulatorSustain:23,modulatorWaveform:0,modulatorKey:128,modulatorOutput:30,feedback:0,carrierTremolo:96,carrierAttack:255,carrierSustain:7,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:224,modulatorAttack:242,modulatorSustain:23,modulatorWaveform:1,modulatorKey:128,modulatorOutput:30,feedback:0,carrierTremolo:160,carrierAttack:255,carrierSustain:7,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Church Organ",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:48,modulatorSustain:4,modulatorWaveform:0,modulatorKey:128,modulatorOutput:18,feedback:9,carrierTremolo:49,carrierAttack:84,carrierSustain:20,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:49,modulatorAttack:84,modulatorSustain:20,modulatorWaveform:2,modulatorKey:128,modulatorOutput:18,feedback:9,carrierTremolo:48,carrierAttack:253,carrierSustain:68,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Reed Organ",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:128,modulatorSustain:23,modulatorWaveform:0,modulatorKey:64,modulatorOutput:9,feedback:6,carrierTremolo:129,carrierAttack:96,carrierSustain:23,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Accordion",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:125,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:162,modulatorSustain:21,modulatorWaveform:0,modulatorKey:64,modulatorOutput:8,feedback:10,carrierTremolo:49,carrierAttack:65,carrierSustain:38,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:32,modulatorAttack:130,modulatorSustain:21,modulatorWaveform:0,modulatorKey:64,modulatorOutput:10,feedback:10,carrierTremolo:49,carrierAttack:70,carrierSustain:38,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Harmonica",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:176,modulatorAttack:96,modulatorSustain:52,modulatorWaveform:0,modulatorKey:0,modulatorOutput:12,feedback:8,carrierTremolo:178,carrierAttack:66,carrierSustain:22,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:176,modulatorAttack:96,modulatorSustain:52,modulatorWaveform:0,modulatorKey:0,modulatorOutput:12,feedback:8,carrierTremolo:178,carrierAttack:66,carrierSustain:22,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:12}]},{name:"Tango Accordion",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:129,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:240,modulatorSustain:5,modulatorWaveform:1,modulatorKey:128,modulatorOutput:18,feedback:8,carrierTremolo:49,carrierAttack:82,carrierSustain:5,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:32,modulatorAttack:240,modulatorSustain:5,modulatorWaveform:1,modulatorKey:128,modulatorOutput:18,feedback:0,carrierTremolo:49,carrierAttack:82,carrierSustain:5,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Acoustic Guitar (nylon)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:241,modulatorSustain:245,modulatorWaveform:0,modulatorKey:128,modulatorOutput:13,feedback:0,carrierTremolo:32,carrierAttack:241,carrierSustain:246,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Acoustic Guitar (steel)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:225,modulatorSustain:228,modulatorWaveform:1,modulatorKey:0,modulatorOutput:13,feedback:10,carrierTremolo:48,carrierAttack:242,carrierSustain:227,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Electric Guitar (jazz)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:241,modulatorSustain:31,modulatorWaveform:2,modulatorKey:0,modulatorOutput:33,feedback:10,carrierTremolo:0,carrierAttack:244,carrierSustain:136,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Electric Guitar (clean)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:234,modulatorSustain:50,modulatorWaveform:1,modulatorKey:128,modulatorOutput:7,feedback:2,carrierTremolo:16,carrierAttack:210,carrierSustain:231,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Electric Guitar (muted)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:224,modulatorSustain:244,modulatorWaveform:0,modulatorKey:128,modulatorOutput:18,feedback:0,carrierTremolo:48,carrierAttack:242,carrierSustain:245,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Overdriven Guitar",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:241,modulatorSustain:255,modulatorWaveform:0,modulatorKey:0,modulatorOutput:6,feedback:2,carrierTremolo:81,carrierAttack:240,carrierSustain:255,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:0,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:0,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Distortion Guitar",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:241,modulatorSustain:255,modulatorWaveform:0,modulatorKey:0,modulatorOutput:13,feedback:12,carrierTremolo:81,carrierAttack:240,carrierSustain:255,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:0,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:0,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Guitar Harmonics",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:161,modulatorSustain:151,modulatorWaveform:2,modulatorKey:64,modulatorOutput:3,feedback:0,carrierTremolo:17,carrierAttack:225,carrierSustain:231,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Acoustic Bass",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:33,modulatorAttack:148,modulatorSustain:6,modulatorWaveform:0,modulatorKey:0,modulatorOutput:14,feedback:2,carrierTremolo:162,carrierAttack:195,carrierSustain:166,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:0,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:0,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Electric Bass (finger)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:240,modulatorSustain:255,modulatorWaveform:0,modulatorKey:128,modulatorOutput:22,feedback:10,carrierTremolo:49,carrierAttack:241,carrierSustain:248,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Electric Bass (pick)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:224,modulatorSustain:20,modulatorWaveform:0,modulatorKey:128,modulatorOutput:15,feedback:8,carrierTremolo:48,carrierAttack:225,carrierSustain:214,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Fretless Bass",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:96,modulatorSustain:0,modulatorWaveform:1,modulatorKey:0,modulatorOutput:26,feedback:8,carrierTremolo:16,carrierAttack:129,carrierSustain:246,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Slap Bass 1",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:240,modulatorSustain:231,modulatorWaveform:2,modulatorKey:0,modulatorOutput:18,feedback:0,carrierTremolo:49,carrierAttack:241,carrierSustain:71,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:16,modulatorAttack:245,modulatorSustain:231,modulatorWaveform:1,modulatorKey:0,modulatorOutput:13,feedback:13,carrierTremolo:16,carrierAttack:246,carrierSustain:231,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Slap Bass 2",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:240,modulatorSustain:229,modulatorWaveform:0,modulatorKey:128,modulatorOutput:16,feedback:8,carrierTremolo:49,carrierAttack:241,carrierSustain:245,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Synth Bass 1",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:244,modulatorSustain:245,modulatorWaveform:1,modulatorKey:0,modulatorOutput:10,feedback:10,carrierTremolo:48,carrierAttack:243,carrierSustain:246,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Synth Bass 2",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:118,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:131,modulatorSustain:70,modulatorWaveform:1,modulatorKey:0,modulatorOutput:21,feedback:10,carrierTremolo:49,carrierAttack:210,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:48,modulatorAttack:131,modulatorSustain:70,modulatorWaveform:1,modulatorKey:0,modulatorOutput:21,feedback:10,carrierTremolo:49,carrierAttack:210,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Violin",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:96,modulatorAttack:80,modulatorSustain:69,modulatorWaveform:1,modulatorKey:0,modulatorOutput:23,feedback:6,carrierTremolo:161,carrierAttack:97,carrierSustain:70,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Viola",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:96,modulatorSustain:68,modulatorWaveform:0,modulatorKey:128,modulatorOutput:15,feedback:2,carrierTremolo:113,carrierAttack:65,carrierSustain:21,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Cello",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:176,modulatorAttack:208,modulatorSustain:20,modulatorWaveform:2,modulatorKey:0,modulatorOutput:15,feedback:6,carrierTremolo:97,carrierAttack:98,carrierSustain:23,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Contrabass",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:177,modulatorSustain:17,modulatorWaveform:2,modulatorKey:128,modulatorOutput:10,feedback:6,carrierTremolo:32,carrierAttack:160,carrierSustain:21,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Tremolo Strings",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:139,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:195,modulatorSustain:1,modulatorWaveform:2,modulatorKey:128,modulatorOutput:9,feedback:6,carrierTremolo:97,carrierAttack:131,carrierSustain:5,carrierWaveform:0,carrierKey:64,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:112,modulatorAttack:179,modulatorSustain:1,modulatorWaveform:2,modulatorKey:128,modulatorOutput:9,feedback:6,carrierTremolo:96,carrierAttack:147,carrierSustain:5,carrierWaveform:1,carrierKey:64,carrierOutput:0,baseNoteOffset:0}]},{name:"Pizzicato Strings",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:248,modulatorSustain:249,modulatorWaveform:2,modulatorKey:128,modulatorOutput:23,feedback:14,carrierTremolo:32,carrierAttack:118,carrierSustain:230,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Orchestral Harp",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:49,modulatorAttack:241,modulatorSustain:53,modulatorWaveform:0,modulatorKey:0,modulatorOutput:36,feedback:0,carrierTremolo:32,carrierAttack:243,carrierSustain:179,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Timpani",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:170,modulatorSustain:200,modulatorWaveform:0,modulatorKey:0,modulatorOutput:4,feedback:10,carrierTremolo:16,carrierAttack:210,carrierSustain:179,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,
carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"String Ensemble 1",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:120,fixedNote:0,voices:[{modulatorTremolo:96,modulatorAttack:192,modulatorSustain:4,modulatorWaveform:1,modulatorKey:64,modulatorOutput:17,feedback:4,carrierTremolo:177,carrierAttack:85,carrierSustain:4,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:160,modulatorAttack:144,modulatorSustain:4,modulatorWaveform:1,modulatorKey:64,modulatorOutput:18,feedback:6,carrierTremolo:49,carrierAttack:85,carrierSustain:4,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"String Ensemble 2",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:133,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:144,modulatorSustain:5,modulatorWaveform:1,modulatorKey:64,modulatorOutput:17,feedback:4,carrierTremolo:161,carrierAttack:53,carrierSustain:5,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:160,modulatorAttack:144,modulatorSustain:5,modulatorWaveform:1,modulatorKey:64,modulatorOutput:18,feedback:6,carrierTremolo:33,carrierAttack:53,carrierSustain:5,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Synth Strings 1",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:123,fixedNote:0,voices:[{modulatorTremolo:161,modulatorAttack:105,modulatorSustain:5,modulatorWaveform:2,modulatorKey:128,modulatorOutput:19,feedback:10,carrierTremolo:241,carrierAttack:102,carrierSustain:2,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:161,modulatorAttack:105,modulatorSustain:5,modulatorWaveform:2,modulatorKey:128,modulatorOutput:19,feedback:10,carrierTremolo:241,carrierAttack:102,carrierSustain:2,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:-12}]},{name:"Synth Strings 2",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:132,fixedNote:0,voices:[{modulatorTremolo:33,modulatorAttack:17,modulatorSustain:3,modulatorWaveform:0,modulatorKey:64,modulatorOutput:13,feedback:0,carrierTremolo:32,carrierAttack:49,carrierSustain:4,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:17,modulatorSustain:51,modulatorWaveform:2,modulatorKey:128,modulatorOutput:2,feedback:8,carrierTremolo:0,carrierAttack:49,carrierSustain:54,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Choir Aahs",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:138,fixedNote:0,voices:[{modulatorTremolo:96,modulatorAttack:144,modulatorSustain:84,modulatorWaveform:0,modulatorKey:64,modulatorOutput:22,feedback:0,carrierTremolo:96,carrierAttack:112,carrierSustain:4,carrierWaveform:0,carrierKey:64,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:32,modulatorAttack:144,modulatorSustain:84,modulatorWaveform:0,modulatorKey:128,modulatorOutput:18,feedback:0,carrierTremolo:96,carrierAttack:112,carrierSustain:4,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0}]},{name:"Voice Oohs",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:177,modulatorSustain:183,modulatorWaveform:0,modulatorKey:128,modulatorOutput:25,feedback:0,carrierTremolo:160,carrierAttack:114,carrierSustain:133,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:18,modulatorAttack:102,modulatorSustain:240,modulatorWaveform:0,modulatorKey:192,modulatorOutput:6,feedback:12,carrierTremolo:81,carrierAttack:174,carrierSustain:182,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:-12}]},{name:"Synth Voice",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:176,modulatorAttack:96,modulatorSustain:84,modulatorWaveform:0,modulatorKey:64,modulatorOutput:26,feedback:0,carrierTremolo:176,carrierAttack:48,carrierSustain:116,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Orchestra Hit",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:48,modulatorSustain:67,modulatorWaveform:0,modulatorKey:128,modulatorOutput:16,feedback:2,carrierTremolo:16,carrierAttack:100,carrierSustain:20,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-24},{modulatorTremolo:144,modulatorAttack:80,modulatorSustain:66,modulatorWaveform:0,modulatorKey:128,modulatorOutput:15,feedback:2,carrierTremolo:17,carrierAttack:84,carrierSustain:69,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12}]},{name:"Trumpet",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:128,modulatorSustain:21,modulatorWaveform:1,modulatorKey:128,modulatorOutput:14,feedback:10,carrierTremolo:48,carrierAttack:81,carrierSustain:54,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Trombone",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:176,modulatorAttack:113,modulatorSustain:31,modulatorWaveform:0,modulatorKey:0,modulatorOutput:26,feedback:14,carrierTremolo:32,carrierAttack:114,carrierSustain:59,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Tuba",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:80,modulatorSustain:70,modulatorWaveform:0,modulatorKey:128,modulatorOutput:22,feedback:12,carrierTremolo:32,carrierAttack:146,carrierSustain:86,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:128,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Muted Trumpet",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:128,modulatorAttack:128,modulatorSustain:230,modulatorWaveform:1,modulatorKey:128,modulatorOutput:13,feedback:12,carrierTremolo:144,carrierAttack:81,carrierSustain:246,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"French Horn",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:129,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:112,modulatorSustain:184,modulatorWaveform:0,modulatorKey:0,modulatorOutput:34,feedback:14,carrierTremolo:32,carrierAttack:97,carrierSustain:150,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:32,modulatorAttack:112,modulatorSustain:184,modulatorWaveform:0,modulatorKey:0,modulatorOutput:35,feedback:14,carrierTremolo:32,carrierAttack:97,carrierSustain:150,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Brass Section",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:131,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:96,modulatorSustain:21,modulatorWaveform:1,modulatorKey:128,modulatorOutput:14,feedback:10,carrierTremolo:48,carrierAttack:81,carrierSustain:54,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:48,modulatorAttack:112,modulatorSustain:23,modulatorWaveform:1,modulatorKey:128,modulatorOutput:18,feedback:14,carrierTremolo:48,carrierAttack:97,carrierSustain:54,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Synth Brass 1",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:134,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:145,modulatorSustain:166,modulatorWaveform:2,modulatorKey:64,modulatorOutput:13,feedback:12,carrierTremolo:32,carrierAttack:129,carrierSustain:151,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:32,modulatorAttack:145,modulatorSustain:166,modulatorWaveform:2,modulatorKey:128,modulatorOutput:12,feedback:12,carrierTremolo:32,carrierAttack:145,carrierSustain:151,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Synth Bass 2",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:134,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:129,modulatorSustain:166,modulatorWaveform:2,modulatorKey:64,modulatorOutput:16,feedback:12,carrierTremolo:48,carrierAttack:97,carrierSustain:151,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:48,modulatorAttack:129,modulatorSustain:166,modulatorWaveform:2,modulatorKey:64,modulatorOutput:10,feedback:10,carrierTremolo:48,carrierAttack:97,carrierSustain:151,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Soprano Sax",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:96,modulatorSustain:5,modulatorWaveform:0,modulatorKey:128,modulatorOutput:22,feedback:6,carrierTremolo:177,carrierAttack:82,carrierSustain:22,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Alto Sax",data:{},flags:2,fixedPitch:false,unknown:true,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:112,modulatorSustain:6,modulatorWaveform:1,modulatorKey:128,modulatorOutput:9,feedback:6,carrierTremolo:176,carrierAttack:98,carrierSustain:22,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Tenor Sax",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:152,modulatorSustain:11,modulatorWaveform:0,modulatorKey:64,modulatorOutput:10,feedback:10,carrierTremolo:176,carrierAttack:115,carrierSustain:11,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Baritone Sax",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:144,modulatorSustain:11,modulatorWaveform:1,modulatorKey:128,modulatorOutput:5,feedback:10,carrierTremolo:176,carrierAttack:99,carrierSustain:27,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Oboe",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:112,modulatorAttack:112,modulatorSustain:22,modulatorWaveform:0,modulatorKey:128,modulatorOutput:16,feedback:6,carrierTremolo:162,carrierAttack:92,carrierSustain:8,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"English Horn",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:200,modulatorSustain:7,modulatorWaveform:0,modulatorKey:64,modulatorOutput:15,feedback:10,carrierTremolo:49,carrierAttack:115,carrierSustain:7,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Bassoon",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:144,modulatorSustain:25,modulatorWaveform:0,modulatorKey:128,modulatorOutput:17,feedback:10,carrierTremolo:49,carrierAttack:97,carrierSustain:27,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Clarinet",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:165,modulatorSustain:23,modulatorWaveform:0,modulatorKey:128,modulatorOutput:13,feedback:8,carrierTremolo:176,carrierAttack:99,carrierSustain:23,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Piccolo",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:110,modulatorSustain:143,modulatorWaveform:0,modulatorKey:128,modulatorOutput:0,feedback:14,carrierTremolo:112,carrierAttack:53,carrierSustain:42,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Flute",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:80,modulatorSustain:136,modulatorWaveform:0,modulatorKey:128,modulatorOutput:19,feedback:8,carrierTremolo:96,carrierAttack:85,carrierSustain:42,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Recorder",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:101,modulatorSustain:23,modulatorWaveform:0,modulatorKey:0,modulatorOutput:10,feedback:11,carrierTremolo:160,carrierAttack:116,carrierSustain:39,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pan Flute",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:176,modulatorAttack:36,modulatorSustain:39,modulatorWaveform:1,modulatorKey:128,modulatorOutput:4,feedback:9,carrierTremolo:176,carrierAttack:69,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:23,modulatorSustain:240,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:14,carrierTremolo:0,carrierAttack:37,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Bottle Blow",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:225,modulatorAttack:87,modulatorSustain:4,modulatorWaveform:0,modulatorKey:128,modulatorOutput:45,feedback:14,carrierTremolo:96,carrierAttack:87,carrierSustain:55,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Shakuhachi",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:241,modulatorAttack:87,modulatorSustain:52,modulatorWaveform:3,modulatorKey:0,modulatorOutput:40,feedback:14,carrierTremolo:225,carrierAttack:103,carrierSustain:93,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Whistle",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:208,modulatorAttack:49,modulatorSustain:15,modulatorWaveform:0,modulatorKey:192,modulatorOutput:7,feedback:11,carrierTremolo:112,carrierAttack:50,carrierSustain:5,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Ocarina",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:176,modulatorAttack:81,modulatorSustain:5,modulatorWaveform:0,modulatorKey:192,modulatorOutput:7,feedback:11,carrierTremolo:48,carrierAttack:66,carrierSustain:41,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 1 (square)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:130,fixedNote:0,voices:[{modulatorTremolo:34,modulatorAttack:81,modulatorSustain:91,modulatorWaveform:1,modulatorKey:64,modulatorOutput:18,feedback:0,carrierTremolo:48,carrierAttack:96,carrierSustain:37,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:34,modulatorAttack:145,modulatorSustain:91,modulatorWaveform:1,modulatorKey:64,modulatorOutput:13,feedback:0,carrierTremolo:48,carrierAttack:240,carrierSustain:37,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 2 (sawtooth)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:127,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:193,modulatorSustain:155,modulatorWaveform:1,modulatorKey:64,modulatorOutput:3,feedback:8,carrierTremolo:49,carrierAttack:192,carrierSustain:101,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:96,modulatorAttack:177,modulatorSustain:171,modulatorWaveform:1,modulatorKey:64,modulatorOutput:1,feedback:8,carrierTremolo:49,carrierAttack:241,carrierSustain:5,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 3 (calliope)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:87,modulatorSustain:51,modulatorWaveform:3,modulatorKey:0,modulatorOutput:40,feedback:14,carrierTremolo:224,carrierAttack:103,carrierSustain:7,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 4 (chiffer)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:130,fixedNote:0,voices:[{modulatorTremolo:224,modulatorAttack:87,modulatorSustain:4,modulatorWaveform:3,modulatorKey:0,modulatorOutput:35,feedback:14,carrierTremolo:224,carrierAttack:103,carrierSustain:77,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:224,modulatorAttack:247,modulatorSustain:4,modulatorWaveform:3,modulatorKey:0,modulatorOutput:35,feedback:14,carrierTremolo:224,carrierAttack:135,carrierSustain:77,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 5 (charang)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:161,modulatorAttack:120,modulatorSustain:11,modulatorWaveform:1,modulatorKey:64,modulatorOutput:2,feedback:8,carrierTremolo:48,carrierAttack:241,carrierSustain:43,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 6 (voice)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:122,fixedNote:0,voices:[{modulatorTremolo:96,modulatorAttack:128,modulatorSustain:85,modulatorWaveform:0,modulatorKey:0,modulatorOutput:33,feedback:8,carrierTremolo:224,carrierAttack:242,carrierSustain:20,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:32,modulatorAttack:144,modulatorSustain:85,modulatorWaveform:0,modulatorKey:0,modulatorOutput:33,feedback:8,carrierTremolo:160,carrierAttack:162,carrierSustain:20,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Lead 7 (5th sawtooth)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:125,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:193,modulatorSustain:149,modulatorWaveform:1,modulatorKey:64,modulatorOutput:3,feedback:10,carrierTremolo:176,carrierAttack:112,carrierSustain:99,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:160,modulatorAttack:145,modulatorSustain:149,modulatorWaveform:1,modulatorKey:64,modulatorOutput:9,feedback:10,carrierTremolo:49,carrierAttack:97,carrierSustain:99,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:-5}]},{name:"Lead 8 (bass & lead)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:36,modulatorAttack:81,modulatorSustain:7,modulatorWaveform:1,modulatorKey:64,modulatorOutput:0,feedback:9,carrierTremolo:160,carrierAttack:253,carrierSustain:41,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* Lead 8 (bass & lead)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:36,modulatorAttack:81,modulatorSustain:7,modulatorWaveform:1,modulatorKey:64,modulatorOutput:0,feedback:9,carrierTremolo:160,carrierAttack:253,carrierSustain:41,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 2 (warm)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:130,fixedNote:0,voices:[{modulatorTremolo:128,modulatorAttack:50,modulatorSustain:5,modulatorWaveform:0,modulatorKey:192,modulatorOutput:0,feedback:9,carrierTremolo:96,carrierAttack:51,carrierSustain:5,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:64,modulatorAttack:50,modulatorSustain:5,modulatorWaveform:0,modulatorKey:64,modulatorOutput:0,feedback:9,carrierTremolo:224,carrierAttack:51,carrierSustain:5,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 3 (polysynth)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:130,fixedNote:0,voices:[{modulatorTremolo:160,modulatorAttack:161,modulatorSustain:165,modulatorWaveform:2,modulatorKey:128,modulatorOutput:15,feedback:12,carrierTremolo:160,carrierAttack:161,carrierSustain:150,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:160,modulatorAttack:161,modulatorSustain:165,modulatorWaveform:2,modulatorKey:128,modulatorOutput:15,feedback:12,carrierTremolo:160,carrierAttack:161,carrierSustain:150,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 4 (choir)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:139,fixedNote:0,voices:[{modulatorTremolo:224,modulatorAttack:240,modulatorSustain:5,modulatorWaveform:0,modulatorKey:64,modulatorOutput:4,feedback:1,carrierTremolo:96,carrierAttack:129,carrierSustain:84,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:224,modulatorAttack:240,modulatorSustain:5,modulatorWaveform:1,modulatorKey:64,modulatorOutput:4,feedback:1,carrierTremolo:96,carrierAttack:113,carrierSustain:84,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 5 (bowed glass)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:128,modulatorAttack:161,modulatorSustain:51,modulatorWaveform:0,modulatorKey:128,modulatorOutput:10,feedback:7,carrierTremolo:224,carrierAttack:82,carrierSustain:84,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 6 (metal)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:129,modulatorAttack:128,modulatorSustain:82,modulatorWaveform:1,modulatorKey:128,modulatorOutput:29,feedback:14,carrierTremolo:64,carrierAttack:35,carrierSustain:83,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 7 (halo)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:126,fixedNote:0,voices:[{modulatorTremolo:225,modulatorAttack:81,modulatorSustain:69,modulatorWaveform:1,modulatorKey:64,modulatorOutput:13,feedback:0,carrierTremolo:160,carrierAttack:145,carrierSustain:70,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:161,modulatorAttack:81,modulatorSustain:69,modulatorWaveform:1,modulatorKey:64,modulatorOutput:13,feedback:0,carrierTremolo:160,carrierAttack:129,carrierSustain:70,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pad 8 (sweep)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:225,modulatorAttack:17,modulatorSustain:82,modulatorWaveform:1,modulatorKey:128,modulatorOutput:12,feedback:8,carrierTremolo:224,carrierAttack:128,carrierSustain:115,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"FX 1 (rain)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:114,modulatorSustain:71,modulatorWaveform:0,modulatorKey:64,modulatorOutput:0,feedback:11,carrierTremolo:131,carrierAttack:248,carrierSustain:25,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"FX 2 (soundtrack)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:136,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:133,modulatorSustain:2,modulatorWaveform:1,modulatorKey:192,modulatorOutput:18,feedback:10,carrierTremolo:193,carrierAttack:69,carrierSustain:18,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:34,modulatorAttack:69,modulatorSustain:3,modulatorWaveform:0,modulatorKey:192,modulatorOutput:18,feedback:10,carrierTremolo:227,carrierAttack:53,carrierSustain:53,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:-5}]},{name:"* FX 3 (crystal)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:4,modulatorAttack:246,modulatorSustain:116,modulatorWaveform:0,modulatorKey:192,modulatorOutput:0,feedback:0,carrierTremolo:2,carrierAttack:163,carrierSustain:36,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-24},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"FX 4 (atmosphere)",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:126,fixedNote:0,voices:[{modulatorTremolo:144,modulatorAttack:192,modulatorSustain:210,modulatorWaveform:0,modulatorKey:128,modulatorOutput:14,feedback:0,carrierTremolo:48,carrierAttack:209,carrierSustain:210,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:144,modulatorAttack:208,modulatorSustain:210,modulatorWaveform:0,modulatorKey:128,modulatorOutput:14,feedback:0,carrierTremolo:48,carrierAttack:241,carrierSustain:210,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"FX 5 (brightness)",
data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:116,fixedNote:0,voices:[{modulatorTremolo:208,modulatorAttack:144,modulatorSustain:243,modulatorWaveform:0,modulatorKey:0,modulatorOutput:18,feedback:0,carrierTremolo:192,carrierAttack:194,carrierSustain:243,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:208,modulatorAttack:144,modulatorSustain:243,modulatorWaveform:0,modulatorKey:0,modulatorOutput:18,feedback:0,carrierTremolo:192,carrierAttack:194,carrierSustain:242,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0}]},{name:"FX 6 (goblin)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:224,modulatorAttack:19,modulatorSustain:82,modulatorWaveform:1,modulatorKey:0,modulatorOutput:26,feedback:0,carrierTremolo:241,carrierAttack:51,carrierSustain:19,carrierWaveform:2,carrierKey:128,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"FX 7 (echo drops)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:224,modulatorAttack:69,modulatorSustain:186,modulatorWaveform:0,modulatorKey:0,modulatorOutput:26,feedback:0,carrierTremolo:240,carrierAttack:50,carrierSustain:145,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"* FX 8 (star-theme)",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:88,modulatorSustain:2,modulatorWaveform:1,modulatorKey:0,modulatorOutput:24,feedback:10,carrierTremolo:2,carrierAttack:66,carrierSustain:114,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Sitar",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:99,modulatorSustain:179,modulatorWaveform:0,modulatorKey:0,modulatorOutput:8,feedback:2,carrierTremolo:36,carrierAttack:99,carrierSustain:179,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Banjo",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:119,modulatorSustain:18,modulatorWaveform:0,modulatorKey:0,modulatorOutput:13,feedback:4,carrierTremolo:16,carrierAttack:243,carrierSustain:244,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:250,modulatorWaveform:2,modulatorKey:0,modulatorOutput:10,feedback:15,carrierTremolo:0,carrierAttack:249,carrierSustain:250,carrierWaveform:3,carrierKey:64,carrierOutput:0,baseNoteOffset:0}]},{name:"Shamisen",data:{},flags:4,fixedPitch:false,unknown:false,doubleVoice:true,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:51,modulatorWaveform:0,modulatorKey:128,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:244,carrierSustain:115,carrierWaveform:2,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:7,modulatorAttack:249,modulatorSustain:172,modulatorWaveform:2,modulatorKey:0,modulatorOutput:26,feedback:0,carrierTremolo:15,carrierAttack:249,carrierSustain:41,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Koto",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:242,modulatorSustain:83,modulatorWaveform:1,modulatorKey:0,modulatorOutput:33,feedback:8,carrierTremolo:34,carrierAttack:145,carrierSustain:228,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Kalimba",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:3,modulatorAttack:241,modulatorSustain:57,modulatorWaveform:3,modulatorKey:64,modulatorOutput:15,feedback:6,carrierTremolo:21,carrierAttack:214,carrierSustain:116,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Bag Pipe",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:137,modulatorSustain:21,modulatorWaveform:1,modulatorKey:64,modulatorOutput:2,feedback:10,carrierTremolo:33,carrierAttack:107,carrierSustain:7,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Fiddle",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:161,modulatorSustain:3,modulatorWaveform:0,modulatorKey:0,modulatorOutput:31,feedback:14,carrierTremolo:33,carrierAttack:82,carrierSustain:38,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Shanai",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:48,modulatorAttack:64,modulatorSustain:19,modulatorWaveform:0,modulatorKey:0,modulatorOutput:19,feedback:8,carrierTremolo:48,carrierAttack:97,carrierSustain:22,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Tinkle Bell",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:19,modulatorAttack:161,modulatorSustain:50,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:1,carrierTremolo:18,carrierAttack:178,carrierSustain:114,carrierWaveform:1,carrierKey:128,carrierOutput:0,baseNoteOffset:-7},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Agogo",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:149,modulatorAttack:231,modulatorSustain:1,modulatorWaveform:0,modulatorKey:128,modulatorOutput:1,feedback:4,carrierTremolo:22,carrierAttack:150,carrierSustain:103,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Steel Drums",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:3,modulatorAttack:240,modulatorSustain:4,modulatorWaveform:1,modulatorKey:64,modulatorOutput:9,feedback:6,carrierTremolo:32,carrierAttack:130,carrierSustain:5,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Woodblock",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:19,modulatorAttack:248,modulatorSustain:209,modulatorWaveform:0,modulatorKey:64,modulatorOutput:4,feedback:6,carrierTremolo:18,carrierAttack:245,carrierSustain:120,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Taiko Drum",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:16,modulatorAttack:167,modulatorSustain:236,modulatorWaveform:0,modulatorKey:0,modulatorOutput:11,feedback:0,carrierTremolo:16,carrierAttack:213,carrierSustain:245,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Melodic Tom",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:32,modulatorAttack:168,modulatorSustain:200,modulatorWaveform:0,modulatorKey:0,modulatorOutput:11,feedback:0,carrierTremolo:1,carrierAttack:214,carrierSustain:183,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Synth Drum",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:248,modulatorSustain:196,modulatorWaveform:0,modulatorKey:0,modulatorOutput:11,feedback:0,carrierTremolo:0,carrierAttack:211,carrierSustain:183,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Reverse Cymbal",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:12,modulatorAttack:65,modulatorSustain:49,modulatorWaveform:0,modulatorKey:128,modulatorOutput:15,feedback:14,carrierTremolo:16,carrierAttack:33,carrierSustain:29,carrierWaveform:3,carrierKey:128,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Guitar Fret Noise",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:50,modulatorAttack:52,modulatorSustain:179,modulatorWaveform:1,modulatorKey:0,modulatorOutput:33,feedback:14,carrierTremolo:49,carrierAttack:84,carrierSustain:247,carrierWaveform:3,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Breath Noise",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:209,modulatorAttack:55,modulatorSustain:4,modulatorWaveform:0,modulatorKey:128,modulatorOutput:45,feedback:14,carrierTremolo:80,carrierAttack:55,carrierSustain:52,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Seashore",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:2,modulatorAttack:62,modulatorSustain:1,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:14,carrierTremolo:8,carrierAttack:20,carrierSustain:243,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Bird Tweet",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:245,modulatorAttack:235,modulatorSustain:3,modulatorWaveform:0,modulatorKey:192,modulatorOutput:20,feedback:7,carrierTremolo:246,carrierAttack:69,carrierSustain:104,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Telephone Ring",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:240,modulatorAttack:218,modulatorSustain:113,modulatorWaveform:1,modulatorKey:0,modulatorOutput:0,feedback:8,carrierTremolo:202,carrierAttack:176,carrierSustain:23,carrierWaveform:1,carrierKey:192,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Helicopter",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:17,voices:[{modulatorTremolo:240,modulatorAttack:30,modulatorSustain:17,modulatorWaveform:1,modulatorKey:0,modulatorOutput:0,feedback:8,carrierTremolo:226,carrierAttack:33,carrierSustain:17,carrierWaveform:1,carrierKey:192,carrierOutput:0,baseNoteOffset:-24},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Applause",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:65,voices:[{modulatorTremolo:239,modulatorAttack:83,modulatorSustain:0,modulatorWaveform:2,modulatorKey:128,modulatorOutput:6,feedback:14,carrierTremolo:239,carrierAttack:16,carrierSustain:2,carrierWaveform:3,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Gun Shot",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:12,modulatorAttack:240,modulatorSustain:240,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:14,carrierTremolo:4,carrierAttack:246,carrierSustain:230,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:-12},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Acoustic Bass Drum",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:38,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:87,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:251,carrierSustain:70,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Acoustic Bass Drum",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:25,voices:[{modulatorTremolo:0,modulatorAttack:250,modulatorSustain:71,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:6,carrierTremolo:0,carrierAttack:249,carrierSustain:6,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Slide Stick",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:83,voices:[{modulatorTremolo:2,modulatorAttack:253,modulatorSustain:103,modulatorWaveform:0,modulatorKey:128,modulatorOutput:0,feedback:6,carrierTremolo:3,carrierAttack:247,carrierSustain:120,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Acoustic Snare",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:32,voices:[{modulatorTremolo:15,modulatorAttack:247,modulatorSustain:20,modulatorWaveform:2,modulatorKey:0,modulatorOutput:5,feedback:14,carrierTremolo:0,carrierAttack:249,carrierSustain:71,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Hand Clap",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:225,modulatorAttack:136,modulatorSustain:251,modulatorWaveform:3,modulatorKey:0,modulatorOutput:0,feedback:15,carrierTremolo:255,carrierAttack:166,carrierSustain:168,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Electric Snare",data:{},flags:5,fixedPitch:true,unknown:false,doubleVoice:true,fineTuning:128,fixedNote:36,voices:[{modulatorTremolo:6,modulatorAttack:170,modulatorSustain:255,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:14,carrierTremolo:0,carrierAttack:247,carrierSustain:250,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:63,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:42}]},{name:"Low Floor Tom",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:15,voices:[{modulatorTremolo:2,modulatorAttack:245,modulatorSustain:108,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:7,carrierTremolo:3,carrierAttack:247,carrierSustain:56,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Closed High-Hat",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:88,voices:[{modulatorTremolo:12,modulatorAttack:152,modulatorSustain:94,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:15,carrierTremolo:15,carrierAttack:251,carrierSustain:6,carrierWaveform:3,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High Floor Tom",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:19,voices:[{modulatorTremolo:2,modulatorAttack:245,modulatorSustain:120,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:7,carrierTremolo:0,carrierAttack:247,carrierSustain:55,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Pedal High Hat",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:88,voices:[{modulatorTremolo:12,modulatorAttack:120,modulatorSustain:94,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:15,carrierTremolo:10,carrierAttack:138,carrierSustain:43,carrierWaveform:3,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low Tom",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:21,voices:[{modulatorTremolo:2,modulatorAttack:245,modulatorSustain:55,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:3,carrierTremolo:2,carrierAttack:247,carrierSustain:55,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Open High Hat",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:79,voices:[{modulatorTremolo:0,modulatorAttack:199,modulatorSustain:1,modulatorWaveform:2,modulatorKey:64,modulatorOutput:5,feedback:14,carrierTremolo:11,carrierAttack:249,carrierSustain:51,carrierWaveform:2,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low-Mid Tom",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:26,voices:[{modulatorTremolo:2,modulatorAttack:245,modulatorSustain:55,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:3,carrierTremolo:2,carrierAttack:247,carrierSustain:55,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High-Mid Tom",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:28,voices:[{modulatorTremolo:2,modulatorAttack:245,modulatorSustain:55,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:3,carrierTremolo:2,carrierAttack:247,carrierSustain:55,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Crash Cymbal 1",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:4,modulatorAttack:194,modulatorSustain:230,modulatorWaveform:0,modulatorKey:0,modulatorOutput:16,feedback:14,carrierTremolo:0,carrierAttack:232,carrierSustain:67,carrierWaveform:3,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High Tom",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:32,voices:[{modulatorTremolo:2,modulatorAttack:245,modulatorSustain:55,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:3,carrierTremolo:2,carrierAttack:247,carrierSustain:55,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Ride Cymbal 1",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:3,modulatorAttack:253,modulatorSustain:18,modulatorWaveform:2,modulatorKey:128,modulatorOutput:0,feedback:10,carrierTremolo:2,carrierAttack:253,carrierSustain:5,carrierWaveform:2,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Chinses Cymbal",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:96,voices:[{modulatorTremolo:0,modulatorAttack:228,modulatorSustain:133,modulatorWaveform:0,modulatorKey:128,modulatorOutput:0,feedback:14,carrierTremolo:192,carrierAttack:215,carrierSustain:52,carrierWaveform:2,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Ride Bell",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:72,voices:[{modulatorTremolo:4,modulatorAttack:226,modulatorSustain:230,modulatorWaveform:0,modulatorKey:128,modulatorOutput:16,feedback:14,carrierTremolo:1,carrierAttack:184,carrierSustain:68,carrierWaveform:1,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Tambourine",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:79,voices:[{modulatorTremolo:2,modulatorAttack:118,modulatorSustain:119,modulatorWaveform:2,modulatorKey:128,modulatorOutput:7,feedback:15,carrierTremolo:1,carrierAttack:152,carrierSustain:103,carrierWaveform:3,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Splash Cymbal",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:69,voices:[{modulatorTremolo:4,modulatorAttack:148,modulatorSustain:112,modulatorWaveform:2,modulatorKey:128,modulatorOutput:1,feedback:14,carrierTremolo:7,carrierAttack:198,carrierSustain:163,carrierWaveform:3,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Cowbell",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:71,voices:[{modulatorTremolo:0,modulatorAttack:253,modulatorSustain:103,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:6,carrierTremolo:1,carrierAttack:246,carrierSustain:152,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Crash Cymbal 2",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:4,modulatorAttack:194,modulatorSustain:230,modulatorWaveform:0,modulatorKey:0,modulatorOutput:16,feedback:14,carrierTremolo:0,carrierAttack:232,carrierSustain:67,carrierWaveform:3,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Vibraslap",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:1,modulatorAttack:249,modulatorSustain:181,modulatorWaveform:0,modulatorKey:0,modulatorOutput:7,feedback:11,carrierTremolo:191,carrierAttack:212,carrierSustain:80,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Ride Cymbal 2",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:3,modulatorAttack:253,modulatorSustain:18,modulatorWaveform:2,modulatorKey:128,modulatorOutput:0,feedback:10,carrierTremolo:2,carrierAttack:253,carrierSustain:5,carrierWaveform:2,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,
modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High Bongo",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:0,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:4,carrierTremolo:0,carrierAttack:250,carrierSustain:38,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low Bango",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:54,voices:[{modulatorTremolo:0,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:4,carrierTremolo:0,carrierAttack:250,carrierSustain:38,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Mute High Conga",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:72,voices:[{modulatorTremolo:0,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:2,modulatorKey:128,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:247,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Open High Conga",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:67,voices:[{modulatorTremolo:0,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:2,modulatorKey:128,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:247,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low Conga",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:60,voices:[{modulatorTremolo:0,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:2,modulatorKey:128,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:247,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High Timbale",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:55,voices:[{modulatorTremolo:3,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:0,modulatorKey:128,modulatorOutput:1,feedback:0,carrierTremolo:0,carrierAttack:247,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low Timbale",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:48,voices:[{modulatorTremolo:3,modulatorAttack:251,modulatorSustain:86,modulatorWaveform:0,modulatorKey:128,modulatorOutput:1,feedback:0,carrierTremolo:0,carrierAttack:247,carrierSustain:23,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High Agogo",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:77,voices:[{modulatorTremolo:1,modulatorAttack:253,modulatorSustain:103,modulatorWaveform:3,modulatorKey:0,modulatorOutput:0,feedback:8,carrierTremolo:1,carrierAttack:246,carrierSustain:152,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low Agogo",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:72,voices:[{modulatorTremolo:1,modulatorAttack:253,modulatorSustain:103,modulatorWaveform:3,modulatorKey:0,modulatorOutput:0,feedback:8,carrierTremolo:1,carrierAttack:246,carrierSustain:152,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Cabasa",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:88,voices:[{modulatorTremolo:12,modulatorAttack:120,modulatorSustain:94,modulatorWaveform:2,modulatorKey:0,modulatorOutput:0,feedback:15,carrierTremolo:10,carrierAttack:138,carrierSustain:43,carrierWaveform:3,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Maracas",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:0,modulatorAttack:90,modulatorSustain:214,modulatorWaveform:2,modulatorKey:0,modulatorOutput:14,feedback:10,carrierTremolo:191,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Short Whistle",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:49,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:199,modulatorWaveform:1,modulatorKey:0,modulatorOutput:7,feedback:10,carrierTremolo:128,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Long Whistle",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:49,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:199,modulatorWaveform:1,modulatorKey:0,modulatorOutput:7,feedback:10,carrierTremolo:128,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Short Guiro",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:49,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:199,modulatorWaveform:1,modulatorKey:0,modulatorOutput:7,feedback:10,carrierTremolo:128,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Long Guiro",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:49,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:199,modulatorWaveform:1,modulatorKey:0,modulatorOutput:7,feedback:10,carrierTremolo:128,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Claves",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:73,voices:[{modulatorTremolo:19,modulatorAttack:248,modulatorSustain:209,modulatorWaveform:1,modulatorKey:64,modulatorOutput:4,feedback:6,carrierTremolo:18,carrierAttack:245,carrierSustain:120,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"High Wood Block",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:68,voices:[{modulatorTremolo:19,modulatorAttack:248,modulatorSustain:209,modulatorWaveform:1,modulatorKey:64,modulatorOutput:4,feedback:6,carrierTremolo:18,carrierAttack:245,carrierSustain:120,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Low Wood Block",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:61,voices:[{modulatorTremolo:19,modulatorAttack:248,modulatorSustain:209,modulatorWaveform:1,modulatorKey:64,modulatorOutput:4,feedback:6,carrierTremolo:18,carrierAttack:245,carrierSustain:120,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Mute Cuica",data:{},flags:0,fixedPitch:false,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:0,voices:[{modulatorTremolo:1,modulatorAttack:94,modulatorSustain:220,modulatorWaveform:1,modulatorKey:0,modulatorOutput:11,feedback:10,carrierTremolo:191,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Open Cuica",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:49,voices:[{modulatorTremolo:0,modulatorAttack:249,modulatorSustain:199,modulatorWaveform:1,modulatorKey:0,modulatorOutput:7,feedback:10,carrierTremolo:128,carrierAttack:255,carrierSustain:255,carrierWaveform:0,carrierKey:192,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Mute Triangle",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:90,voices:[{modulatorTremolo:197,modulatorAttack:242,modulatorSustain:96,modulatorWaveform:0,modulatorKey:64,modulatorOutput:15,feedback:8,carrierTremolo:212,carrierAttack:244,carrierSustain:122,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]},{name:"Open Triangle",data:{},flags:1,fixedPitch:true,unknown:false,doubleVoice:false,fineTuning:128,fixedNote:90,voices:[{modulatorTremolo:133,modulatorAttack:242,modulatorSustain:96,modulatorWaveform:1,modulatorKey:64,modulatorOutput:15,feedback:8,carrierTremolo:148,carrierAttack:242,carrierSustain:183,carrierWaveform:0,carrierKey:128,carrierOutput:0,baseNoteOffset:0},{modulatorTremolo:0,modulatorAttack:0,modulatorSustain:240,modulatorWaveform:0,modulatorKey:0,modulatorOutput:0,feedback:0,carrierTremolo:0,carrierAttack:0,carrierSustain:240,carrierWaveform:0,carrierKey:0,carrierOutput:0,baseNoteOffset:0}]}],lump:{}}},{}],3:[function(_dereq_,module,exports){var extend=_dereq_("extend");function IMF(opl){this.opl=opl}module.exports=IMF;extend(IMF.prototype,{load:function(buffer){this.data=new DataView(buffer.buffer);this.size=this.data.getUint16(0,true);if(!this.size){this.type=0;this.position=0;this.size=this.data.byteLength}else{this.type=1;this.position=2}},update:function(){this.delay=0;while(!this.delay&&this.position<this.size){try{var reg=this.data.getUint8(this.position++);var value=this.data.getUint8(this.position++);this.delay=this.data.getUint16(this.position,true);this.position+=2;this.midi_write_adlib(reg,value);if(this.delay)return true}catch(err){break}}return false},rewind:function(){this.position=0},refresh:function(){return this.delay/700},midi_write_adlib:function(r,v){var a=0;if(r>=256){a=1;r-=256}this.opl.write(a,r,v)}})},{extend:21}],4:[function(_dereq_,module,exports){var extend=_dereq_("extend");function LAA(opl,options){options=options||{};this.opl=opl;this.channels=[];this.tracks=[];this.adlib_data=new Int32Array(256);var Midi=options.Midi;if(typeof Midi!="undefined"){this.Midi=Midi;this.midiFile=new Midi.File;this.midiTrack=new Midi.Track;this.midiFile.addTrack(this.midiTrack)}for(var i=0;i<16;i++){this.channels.push(new MidiChannel);this.tracks.push(new MidiTrack);if(typeof Midi!="undefined"){this.channels[i].midiTrack=this.midiTrack}}this.myinsbank=new Array(128);this.smyinsbank=new Array(128);for(var i=0;i<128;i++){this.myinsbank[i]=new Int32Array(16);this.smyinsbank[i]=new Int32Array(16)}this.chp=new Array(18);for(var i=0;i<18;i++){this.chp[i]=new Int32Array(3)}}module.exports=LAA;extend(LAA.prototype,{ADL:[65,68,76],LUCAS_STYLE:1,CMF_STYLE:2,MIDI_STYLE:4,SIERRA_STYLE:8,ADLIB_MELODIC:0,ADLIB_RYTHM:1,FILE_LUCAS:"LucasArts AdLib MIDI",adlib_opadd:[0,1,2,8,9,10,16,17,18],ops:[32,32,64,64,96,96,128,128,224,224,192],map_chan:[20,18,21,17],fnums:[363,385,408,432,458,485,514,544,577,611,647,686],percussion_map:[6,7,8,8,7],load:function(buffer){if(!(buffer instanceof Uint8Array))buffer=new Uint8Array(buffer);this.position=0;if(buffer[0]==this.ADL[0]&&buffer[1]==this.ADL[1]&&buffer[2]==this.ADL[2]){this.type=this.FILE_LUCAS;this.subsongs=1}this.data=buffer;this.rewind(0)},update:function(){var w,note,vel,ctrl,nv,x,l,lnum;var i=0,j,c;var on,onl,numchan;var ret;if(this.doing==1){for(var curtrack=0;curtrack<16;curtrack++){if(this.tracks[curtrack].on!=0){this.position=this.tracks[curtrack].pos;if(this.type!=this.FILE_SIERRA&&this.type!=this.FILE_ADVSIERRA)this.tracks[curtrack].iwait+=this.getval();else this.tracks[curtrack].iwait+=this.getnext(1);this.tracks[curtrack].pos=this.position}}this.doing=0}this.iwait=0;ret=1;while(this.iwait==0&&ret==1){for(var curtrack=0;curtrack<16;curtrack++){if(this.tracks[curtrack].on!=0&&this.tracks[curtrack].iwait==0&&this.tracks[curtrack].pos<this.tracks[curtrack].tend){this.position=this.tracks[curtrack].pos;var v=this.getnext(1);if(v<128){v=this.tracks[curtrack].pv;this.position--}this.tracks[curtrack].pv=v;var c=v&15;switch(v&240){case 128:var note=this.getnext(1);var vel=this.getnext(1);for(var i=0;i<9;i++){if(this.chp[i][0]==c&&this.chp[i][1]==note){this.midi_fm_endnote(i);this.chp[i][0]=-1}}break;case 144:var note=this.getnext(1);var vel=this.getnext(1);var numchan=this.adlib_mode==this.ADLIB_RYTHM?6:9;if(this.channels[c].on!=0){for(var i=0;i<18;i++)this.chp[i][2]++;if(c<11||this.adlib_mode==this.ADLIB_MELODIC){var j=0;var on=-1;var onl=0;for(var i=0;i<numchan;i++){if(this.chp[i][0]==-1&&this.chp[i][2]>onl){onl=this.chp[i][2];on=i;j=1}}if(on==-1){onl=0;for(var i=0;i<numchan;i++){if(this.chp[i][2]>onl){onl=this.chp[i][2];on=i}}}if(j==0)this.midi_fm_endnote(on)}else on=this.percussion_map[c-11];if(vel!=0&&this.channels[c].inum>=0&&this.channels[c].inum<128){if(this.adlib_mode==this.ADLIB_MELODIC||c<12)this.midi_fm_instrument(on,this.channels[c].ins);else this.midi_fm_percussion(c,this.channels[c].ins);var nv;if((this.adlib_style&this.MIDI_STYLE)!=0){nv=this.channels[c].vol*vel/128|0;if((this.adlib_style&this.LUCAS_STYLE)!=0)nv*=2;if(nv>127)nv=127;nv=this.midi_fm_vol_table[nv];if((this.adlib_style&this.LUCAS_STYLE)!=0)nv=Math.sqrt(nv)*11|0}else nv=vel;this.midi_fm_playnote(on,note+this.channels[c].nshift,nv*2);this.chp[on][0]=c;this.chp[on][1]=note;this.chp[on][2]=0;if(this.midiFile){this.midiTrack.note(c,note,32)}if(this.adlib_mode==this.ADLIB_RYTHM&&c>=11){this.midi_write_adlib(189,this.adlib_data[189]&~(16>>c-11));this.midi_write_adlib(189,this.adlib_data[189]|16>>c-11)}}else{if(vel==0){for(var i=0;i<9;i++){if(this.chp[i][0]==c&&this.chp[i][1]==note){this.midi_fm_endnote(i);this.midiTrack.noteOff(c,note);this.chp[i][0]=-1}}}else{this.chp[on][0]=-1;this.chp[on][2]=0}}}else console.error("channel off",c,this.position);break;case 160:var note=this.getnext(1);var vel=this.getnext(1);break;case 176:var ctrl=this.getnext(1);var vel=this.getnext(1);switch(ctrl){case 7:this.channels[c].vol=vel;break;case 103:if((this.adlib_style&this.CMF_STYLE)!=0){this.adlib_mode=vel;if(this.adlib_mode==this.ADLIB_RYTHM)this.midi_write_adlib(189,this.adlib_data[189]|1<<5);else this.midi_write_adlib(189,this.adlib_data[189]&~(1<<5))}break}break;case 192:var x=this.getnext(1);this.channels[c].inum=x;if(this.midiFile)this.channels[c].midiTrack.instrument(c,x);for(var j=0;j<11;j++)this.channels[c].ins[j]=this.myinsbank[this.channels[c].inum][j];break;case 208:var x=this.getnext(1);break;case 224:var x1=this.getnext(1);var x2=this.getnext(1);break;case 240:switch(v){case 240:case 247:var l=this.getval();var t=0;if(this.datalook(this.position+l)==247)t=1;if(this.datalook(this.position)==125&&this.datalook(this.position+1)==16&&this.datalook(this.position+2)<16){this.adlib_style=this.LUCAS_STYLE|this.MIDI_STYLE;this.getnext(1);this.getnext(1);c=this.getnext(1);this.getnext(1);this.channels[c].ins[0]=(this.getnext(1)<<4)+this.getnext(1);this.channels[c].ins[2]=255-((this.getnext(1)<<4)+this.getnext(1)&63);this.channels[c].ins[4]=255-((this.getnext(1)<<4)+this.getnext(1));this.channels[c].ins[6]=255-((this.getnext(1)<<4)+this.getnext(1));this.channels[c].ins[8]=(this.getnext(1)<<4)+this.getnext(1);this.channels[c].ins[1]=(this.getnext(1)<<4)+this.getnext(1);this.channels[c].ins[3]=255-((this.getnext(1)<<4)+this.getnext(1)&63);this.channels[c].ins[5]=255-((this.getnext(1)<<4)+this.getnext(1));this.channels[c].ins[7]=255-((this.getnext(1)<<4)+this.getnext(1));this.channels[c].ins[9]=(this.getnext(1)<<4)+this.getnext(1);i=(this.getnext(1)<<4)+this.getnext(1);this.channels[c].ins[10]=i;i=11;this.getnext(l-26)}else{for(var j=0;j<l;j++){this.getnext(1)}}if(t==1)this.getnext(1);break;case 241:break;case 242:this.getnext(2);break;case 243:this.getnext(1);break;case 244:break;case 245:break;case 246:case 248:case 250:case 251:case 252:if(this.type==this.FILE_SIERRA||this.type==this.FILE_ADVSIERRA){this.tracks[curtrack].tend=this.position}break;case 254:break;case 253:break;case 255:var v=this.getnext(1);var l=this.getval();if(v==81){this.msqtr=this.getnext(l)}else{for(var i=0;i<l;i++)this.getnext(1)}break}break;default:console.error("!",v)}if(this.position<this.tracks[curtrack].tend){this.tracks[curtrack].iwait=this.type!=this.FILE_SIERRA&&this.type!=this.FILE_ADVSIERRA?this.getval():this.getnext(1)}else this.tracks[curtrack].iwait=0;this.tracks[curtrack].pos=this.position}}ret=0;this.iwait=0;for(var curtrack=0;curtrack<16;curtrack++){if(this.tracks[curtrack].on==1&&this.tracks[curtrack].pos<this.tracks[curtrack].tend){ret=1;break}}if(ret==1){this.iwait=16777215;for(var curtrack=0;curtrack<16;curtrack++){if(this.tracks[curtrack].on==1&&this.tracks[curtrack].pos<this.tracks[curtrack].tend&&this.tracks[curtrack].iwait<this.iwait)this.iwait=this.tracks[curtrack].iwait}}}if(this.iwait!=0&&ret==1){for(var curtrack=0;curtrack<16;curtrack++){if(this.tracks[curtrack].on!=0)this.tracks[curtrack].iwait-=this.iwait}this.fwait=this.iwait/this.deltas*(this.msqtr/1e6)}else this.fwait=1/50;return ret!=0},rewind:function(subsong){this.position=0;this.tins=0;this.adlib_style=this.MIDI_STYLE|this.CMF_STYLE;this.adlib_mode=this.ADLIB_MELODIC;for(var i=0;i<128;i++){for(var j=0;j<14;j++){this.myinsbank[i][j]=this.midi_fm_instruments[i][j]}this.myinsbank[i][14]=0;this.myinsbank[i][15]=0}for(var i=0;i<16;i++){this.channels[i].inum=0;for(var j=0;j<11;j++){this.channels[i].ins[j]=this.myinsbank[this.channels[i].inum][j]}this.channels[i].vol=127;this.channels[i].nshift=-25;this.channels[i].on=1}for(var i=0;i<9;i++){this.chp[i][0]=-1;this.chp[i][2]=0}this.deltas=250;this.msqtr=5e5;this.fwait=1/123;this.iwait=0;this.subsongs=1;for(var i=0;i<16;i++){this.tracks[i].tend=0;this.tracks[i].spos=0;this.tracks[i].pos=0;this.tracks[i].iwait=0;this.tracks[i].on=0;this.tracks[i].pv=0}this.curtrack=0;this.position=0;var n=this.getnext(1);switch(this.type){case this.FILE_LUCAS:this.getnext(24);this.adlib_style=this.LUCAS_STYLE|this.MIDI_STYLE;case this.FILE_MIDI:if(this.type!=this.FILE_LUCAS)this.tins=128;this.getnext(11);this.deltas=this.getnext(2);this.getnext(4);var track=this.tracks[0];track.on=1;track.tend=this.getnext(4);track.spos=this.position;break}for(var i=0;i<16;i++){if(this.tracks[i].on!=0){this.tracks[i].pos=this.tracks[i].spos;this.tracks[i].pv=0;this.tracks[i].iwait=0}}this.doing=1;this.midi_fm_reset()},refresh:function(){return Math.min(this.fwait,100)},datalook:function(pos){return this.position<0||this.position>=this.data.length?0:this.data[pos]},getnexti:function(num){var v=0;for(var i=0;i<num;i++){v+=this.datalook(this.position)<<8*i;this.position++}return v},getnext:function(num){var v=0;for(var i=0;i<num;i++){v<<=8;v+=this.datalook(this.position);this.position++}return v},getval:function(){var b=this.getnext(1);var v=b&127;while((b&128)!=0){b=this.getnext(1);v=(v<<7)+(b&127)}return v},midi_write_adlib:function(r,v){this.opl.write(0,r,v);this.adlib_data[r]=v},midi_fm_instrument:function(voice,inst){this.midi_write_adlib(32+this.adlib_opadd[voice],inst[0]);this.midi_write_adlib(35+this.adlib_opadd[voice],inst[1]);if((this.adlib_style&this.LUCAS_STYLE)!=0){this.midi_write_adlib(67+this.adlib_opadd[voice],63);if((inst[10]&1)==0)this.midi_write_adlib(64+this.adlib_opadd[voice],inst[2]);else this.midi_write_adlib(64+this.adlib_opadd[voice],63)}this.midi_write_adlib(96+this.adlib_opadd[voice],inst[4]);this.midi_write_adlib(99+this.adlib_opadd[voice],inst[5]);this.midi_write_adlib(128+this.adlib_opadd[voice],inst[6]);this.midi_write_adlib(131+this.adlib_opadd[voice],inst[7]);this.midi_write_adlib(224+this.adlib_opadd[voice],inst[8]);this.midi_write_adlib(227+this.adlib_opadd[voice],inst[9])},midi_fm_percussion:function(ch,inst){var opadd=this.map_chan[ch-12];this.midi_write_adlib(32+opadd,inst[0]);this.midi_write_adlib(64+opadd,inst[2]);this.midi_write_adlib(96+opadd,inst[4]);this.midi_write_adlib(128+opadd,inst[6]);this.midi_write_adlib(224+opadd,inst[8])},midi_fm_volume:function(voice,volume){var vol=volume>>2;if((this.adlib_data[192+voice]&1)==1)this.midi_write_adlib(64+this.adlib_opadd[voice],63-vol|this.adlib_data[64+this.adlib_opadd[voice]]&192);this.midi_write_adlib(67+this.adlib_opadd[voice],63-vol|this.adlib_data[67+this.adlib_opadd[voice]]&192)},midi_fm_playnote:function(voice,note,volume){if(note<0)note=12-note%12;var freq=this.fnums[note%12];var oct=note/12|0;this.midi_fm_volume(voice,volume);this.midi_write_adlib(160+voice,freq&255);var c=((freq&768)>>8)+(oct<<2)+(this.adlib_mode==this.ADLIB_MELODIC||voice<6?1<<5:0);this.midi_write_adlib(176+voice,c)},midi_fm_endnote:function(voice){this.midi_write_adlib(176+voice,this.adlib_data[176+voice]&255-32)},midi_fm_reset:function(){for(var i=0;i<256;i++){this.midi_write_adlib(i,0)}for(var i=192;i<=200;i++){this.midi_write_adlib(i,240)}this.midi_write_adlib(1,32);this.midi_write_adlib(189,192)},midi_fm_instruments:[[33,33,143,12,242,242,69,118,0,0,8,0,0,0],[49,33,75,9,242,242,84,86,0,0,8,0,0,0],[49,33,73,9,242,242,85,118,0,0,8,0,0,0],[177,97,14,9,242,243,59,11,0,0,6,0,0,0],[1,33,87,9,241,241,56,40,0,0,0,0,0,0],[1,33,147,9,241,241,56,40,0,0,0,0,0,0],[33,54,128,23,162,241,1,213,0,0,8,0,0,0],[1,1,146,9,194,194,168,88,0,0,10,0,0,0],[12,129,92,9,246,243,84,181,0,0,0,0,0,0],[7,17,151,137,246,245,50,17,0,0,2,0,0,0],[23,1,33,9,86,246,4,4,0,0,2,0,0,0],[24,129,98,9,243,242,230,246,0,0,0,0,0,0],[24,33,35,9,247,229,85,216,0,0,0,0,0,0],[21,1,145,9,246,246,166,230,0,0,4,0,0,0],[69,129,89,137,211,163,130,227,0,0,12,0,0,0],[3,129,73,137,116,179,85,5,1,0,4,0,0,0],[113,49,146,9,246,241,20,7,0,0,2,0,0,0],[114,48,20,9,199,199,88,8,0,0,2,0,0,0],[112,177,68,9,170,138,24,8,0,0,4,0,0,0],[35,177,147,9,151,85,35,20,1,0,4,0,0,0],[97,177,19,137,151,85,4,4,1,0,0,0,0,0],[36,177,72,9,152,70,42,26,1,0,12,0,0,0],[97,33,19,9,145,97,6,7,1,0,10,0,0,0],[33,161,19,146,113,97,6,7,0,0,6,0,0,0],[2,65,156,137,243,243,148,200,1,0,12,0,0,0],[3,17,84,9,243,241,154,231,1,0,12,0,0,0],[35,33,95,9,241,242,58,248,0,0,0,0,0,0],[3,33,135,137,246,243,34,248,1,0,6,0,0,0],[3,33,71,9,249,246,84,58,0,0,0,0,0,0],[35,33,74,14,145,132,65,25,1,0,8,0,0,0],[35,33,74,9,149,148,25,25,1,0,8,0,0,0],[9,132,161,137,32,209,79,248,0,0,8,0,0,0],[33,162,30,9,148,195,6,166,0,0,2,0,0,0],[49,49,18,9,241,241,40,24,0,0,10,0,0,0],[49,49,141,9,241,241,232,120,0,0,10,0,0,0],[49,50,91,9,81,113,40,72,0,0,12,0,0,0],[1,33,139,73,161,242,154,223,0,0,8,0,0,0],[33,33,139,17,162,161,22,223,0,0,8,0,0,0],[49,49,139,9,244,241,232,120,0,0,10,0,0,0],[49,49,18,9,241,241,40,24,0,0,10,0,0,0],[49,33,21,9,221,86,19,38,1,0,8,0,0,0],[49,33,22,9,221,102,19,6,1,0,8,0,0,0],[113,49,73,9,209,97,28,12,1,0,8,0,0,0],[33,35,77,137,113,114,18,6,1,0,2,0,0,0],[241,225,64,9,241,111,33,22,1,0,2,0,0,0],[2,1,26,137,245,133,117,53,1,0,0,0,0,0],[2,1,29,137,245,243,117,244,1,0,0,0,0,0],[16,17,65,9,245,242,5,195,1,0,2,0,0,0],[33,162,155,10,177,114,37,8,1,0,14,0,0,0],[161,33,152,9,127,63,3,7,1,1,0,0,0,0],[161,97,147,9,193,79,18,5,0,0,10,0,0,0],[33,97,24,9,193,79,34,5,0,0,12,0,0,0],[49,114,91,140,244,138,21,5,0,0,0,0,0,0],[161,97,144,9,116,113,57,103,0,0,0,0,0,0],[113,114,87,9,84,122,5,5,0,0,12,0,0,0],[144,65,0,9,84,165,99,69,0,0,8,0,0,0],[33,33,146,10,133,143,23,9,0,0,12,0,0,0],[33,33,148,14,117,143,23,9,0,0,12,0,0,0],[33,97,148,9,118,130,21,55,0,0,12,0,0,0],[49,33,67,9,158,98,23,44,1,1,2,0,0,0],[33,33,155,9,97,127,106,10,0,0,2,0,0,0],[97,34,138,15,117,116,31,15,0,0,8,0,0,0],[161,33,134,140,114,113,85,24,1,0,0,0,0,0],[33,33,77,9,84,166,60,28,0,0,8,0,0,0],[49,97,143,9,147,114,2,11,1,0,8,0,0,0],[49,97,142,9,147,114,3,9,1,0,8,0,0,0],[49,97,145,9,147,130,3,9,1,0,10,0,0,0],[49,97,142,9,147,114,15,15,1,0,10,0,0,0],[33,33,75,9,170,143,22,10,1,0,8,0,0,0],[49,33,144,9,126,139,23,12,1,1,6,0,0,0],[49,50,129,9,117,97,25,25,1,0,0,0,0,0],[50,33,144,9,155,114,33,23,0,0,4,0,0,0],[225,225,31,9,133,101,95,26,0,0,0,0,0,0],[225,225,70,9,136,101,95,26,0,0,0,0,0,0],[161,33,156,9,117,117,31,10,0,0,2,0,0,0],[49,33,139,9,132,101,88,26,0,0,0,0,0,0],[225,161,76,9,102,101,86,38,0,0,0,0,0,0],[98,161,203,9,118,85,70,54,0,0,0,0,0,0],[98,161,162,9,87,86,7,7,0,0,11,0,0,0],[98,161,156,9,119,118,7,7,0,0,11,0,0,0],[34,33,89,9,255,255,3,15,2,0,0,0,0,0],[33,33,14,9,255,255,15,15,1,1,0,0,0,0],[34,33,70,137,134,100,85,24,0,0,0,0,0,0],[33,161,69,9,102,150,18,10,0,0,0,0,0,0],[33,34,139,9,146,145,42,42,1,0,0,0,0,0],[162,97,158,73,223,111,5,7,0,0,2,0,0,0],[32,96,26,9,239,143,1,6,0,2,0,0,0,0],[33,33,143,134,241,244,41,9,0,0,10,0,0,0],[119,161,165,9,83,160,148,5,0,0,2,0,0,0],[97,177,31,137,168,37,17,3,0,0,10,0,0,0],[97,97,23,9,145,85,52,22,0,0,12,0,0,0],[113,114,93,9,84,106,1,3,0,0,0,0,0,0],[33,162,151,9,33,66,67,53,0,0,8,0,0,0],[161,33,28,9,161,49,119,71,1,1,0,0,0,0],[33,97,137,12,17,66,51,37,0,0,10,0,0,0],[161,33,21,9,17,207,71,7,1,0,0,0,0,0],[58,81,206,9,248,134,246,2,0,0,2,0,0,0],[33,33,21,9,33,65,35,19,1,0,0,0,0,0],[6,1,91,9,116,165,149,114,0,0,0,0,0,0],[34,97,146,140,177,242,129,38,0,0,12,0,0,0],[65,66,77,9,241,242,81,245,1,0,0,0,0,0],[97,163,148,137,17,17,81,19,1,0,6,0,0,0],[97,161,140,137,17,29,49,3,0,0,6,0,0,0],[164,97,76,9,243,129,115,35,1,0,4,0,0,0],[2,7,133,12,210,242,83,246,0,1,0,0,0,0],[17,19,12,137,163,162,17,229,1,0,0,0,0,0],[17,17,6,9,246,242,65,230,1,2,4,0,0,0],[147,145,145,9,212,235,50,17,0,1,8,0,0,0],[4,1,79,9,250,194,86,5,0,0,12,0,0,0],[33,34,73,9,124,111,32,12,0,1,6,0,0,0],[49,33,133,9,221,86,51,22,1,0,10,0,0,0],[32,33,4,138,218,143,5,11,2,0,6,0,0,0],[5,3,106,137,241,195,229,229,0,0,6,0,0,0],[7,2,21,9,236,248,38,22,0,0,10,0,0,0],[5,1,157,9,103,223,53,5,0,0,8,0,0,0],[24,18,150,9,250,248,40,229,0,0,10,0,0,0],[16,0,134,12,168,250,7,3,0,0,6,0,0,0],[17,16,65,12,248,243,71,3,2,0,4,0,0,0],[1,16,142,9,241,243,6,2,2,0,14,0,0,0],[14,192,0,9,31,31,0,255,0,3,14,0,0,0],[6,3,128,145,248,86,36,132,0,2,14,0,0,0],[14,208,0,14,248,52,0,4,0,3,14,0,0,0],[14,192,0,9,246,31,0,2,0,3,14,0,0,0],[213,218,149,73,55,86,163,55,0,0,0,0,0,0],[53,20,92,17,178,244,97,21,2,0,10,0,0,0],[14,208,0,9,246,79,0,245,0,3,14,0,0,0],[38,228,0,9,255,18,1,22,0,1,14,0,0,0],[0,0,0,9,243,246,240,201,0,2,14,0,0,0]],midi_fm_vol_table:[0,11,16,19,22,25,27,29,32,33,35,37,39,40,42,43,45,46,48,49,50,51,53,54,55,56,57,58,59,60,61,62,64,64,65,66,67,68,69,70,71,72,73,74,75,75,76,77,78,79,80,80,81,82,83,83,84,85,86,86,87,88,89,89,90,91,91,92,93,93,94,95,96,96,97,97,98,99,99,100,101,101,102,103,103,104,104,105,106,106,107,107,108,109,109,110,110,111,112,112,113,113,114,114,115,115,116,117,117,118,118,119,119,120,120,121,121,122,122,123,123,124,124,125,125,126,126,127]});function MidiChannel(){this.ins=new Int32Array(11)}function MidiTrack(){}},{extend:21}],5:[function(_dereq_,module,exports){var extend=_dereq_("extend");var GENMIDI=_dereq_("wad-genmidi");function MUS(opl,options){options=options||{};this.opl=opl;if(options.instruments&&(options.instruments.buffer||options.instruments)instanceof ArrayBuffer)options.instruments=new GENMIDI(options.instruments).instruments;this.instruments=options.instruments||_dereq_("./genmidi.json").instruments;this.Midi=options.Midi;this.onlyMidi=options.onlyMidi||false}module.exports=MUS;extend(MUS.prototype,{op_num:[0,1,2,8,9,10,16,17,18],CtrlTranslate:[0,0,1,7,10,11,91,93,64,67,120,123,126,127,121],MUS:1297437466,CH_SECONDARY:1,CH_SUSTAIN:2,CH_VIBRATO:4,CH_FREE:128,OPL2CHANNELS:9,OPL3CHANNELS:18,MUSctrl:{ctrlPatch:0,ctrlBank:1,ctrlModulation:2,ctrlVolume:3,ctrlPan:4,ctrlExpression:5,ctrlReverb:6,ctrlChorus:7,ctrlSustainPedal:8,ctrlSoftPedal:9,ctrlRPNHi:10,ctrlRPNLo:11,ctrlNRPNHi:12,ctrlNRPNLo:13,ctrlDataEntryHi:14,ctrlDataEntryLo:15,ctrlSoundsOff:16,ctrlNotesOff:17,ctrlMono:18,
ctrlPoly:19},MIDItoOPLctrl:{0:1,1:2,6:14,7:3,10:4,11:5,38:15,64:8,67:9,91:6,93:7,98:13,99:12,100:11,101:10,120:16,123:17,126:18,127:19},PERCUSSION:15,MOD_MIN:40,load:function(buffer){this.data=new DataView(buffer.buffer||buffer);if(this.data.getInt32(0)!=this.MUS)throw new Error("Buffer is not a MUS file");this.scoreLength=this.data.getUint16(4,true);this.scoreStart=this.data.getUint16(6,true);this.channelCount=this.data.getUint16(8,true);this.secondaryChannels=this.data.getUint16(10,true);this.instrumentsCount=this.data.getUint16(12,true);this.channelInstruments=[];for(var i=0,j=16;i<this.instrumentsCount;i++,j+=2){this.channelInstruments.push(this.data.getUint16(j,true))}this.channels=[];this.OPLchannels=this.OPL3CHANNELS;for(var i=0;i<this.OPLchannels;i++){this.channels[i]={}}this.position=0;this.voices=[];for(var i=0;i<this.OPLchannels;i++){this.voices[i]={channel:-1,note:0,flags:0,realnote:0,finetune:0,pitch:0,volume:0,realvolume:0,instr:null,time:0}}this.driverdata={channelInstr:new Uint32Array(this.OPLchannels),channelVolume:new Uint8Array(this.OPLchannels),channelLastVolume:new Uint8Array(this.OPLchannels),channelPan:new Int8Array(this.OPLchannels),channelPitch:new Int8Array(this.OPLchannels),channelSustain:new Uint8Array(this.OPLchannels),channelModulation:new Uint8Array(this.OPLchannels),channelPitchSens:new Uint16Array(this.OPLchannels),channelRPN:new Uint16Array(this.OPLchannels),channelExpression:new Uint8Array(this.OPLchannels)};this.rewind()},update:function(){if(this.position>=this.data.byteLength){return false}var last=0;while(!last){var deltaTime=this.deltaTime;var event=this.data.getUint8(this.position++);var channel=event&15;var type=(event&112)>>4;last=event&128;var midiChannel=channel;if(midiChannel==15)midiChannel=9;else if(midiChannel>=9)midiChannel++;if(this.midiTrack){if(!this.chanUsed[channel]){this.chanUsed[channel]=true;this.midiTrack.addEvent(new this.Midi.Event({type:this.Midi.Event.CONTROLLER,channel:midiChannel,param1:7,param2:127}))}}switch(type){case 0:var note=this.data.getUint8(this.position++)&127;this.playingcount--;this.OPLreleaseNote(channel,note);if(this.midiTrack){this.midiTrack.noteOff(midiChannel,note,deltaTime)}break;case 1:var data=this.data.getUint8(this.position++);var note=data&127;var volume=this.driverdata.channelLastVolume[channel];if(data&128){volume=this.data.getUint8(this.position++)&127}this.playingcount++;this.OPLplayNote(channel,note,volume);if(this.midiTrack){this.midiTrack.noteOn(midiChannel,note,deltaTime,volume)}break;case 2:var pitch=this.data.getUint8(this.position++);this.OPLpitchWheel(channel,(pitch&1)<<6|(pitch>>1&127)<<7);if(this.midiTrack){this.midiTrack.addEvent(new this.Midi.Event({type:this.Midi.Event.PITCH_BEND,channel:midiChannel,param1:(pitch&1)<<6,param2:pitch>>1&127,time:deltaTime}))}break;case 3:var number=this.data.getUint8(this.position++)&127;if(number<10||number>14){}else if(this.midiTrack){this.midiTrack.addEvent(new this.Midi.Event({type:this.Midi.Event.CONTROLLER,channel:midiChannel,param1:this.CtrlTranslate[number],param2:number==12?this.channelCount:0,time:deltaTime}))}break;case 4:var ctrl=this.data.getUint8(this.position++)&127;var value=this.data.getUint8(this.position++)&127;if(ctrl==0){this.OPLprogramChange(channel,value);if(this.midiTrack){this.midiTrack.instrument(midiChannel,value,deltaTime)}}else{if(this.CtrlTranslate[ctrl]==121)this.OPLresetControllers(channel,100);else this.OPLchangeControl(channel,this.MIDItoOPLctrl[this.CtrlTranslate[ctrl]],value);if(this.midiTrack&&ctrl>0&&ctrl<10){this.midiTrack.addEvent(new this.Midi.Event({type:this.Midi.Event.CONTROLLER,channel:midiChannel,param1:this.CtrlTranslate[ctrl],param2:value,time:deltaTime}))}}break;case 6:this.OPLstopMusic();this.OPLshutup();if(this.midiTrack){this.midiTrack.addEvent(new this.Midi.MetaEvent({type:this.Midi.MetaEvent.END_OF_TRACK}));this.midiBuffer=this.midiFile.toBytes()}this.rewind();return false}var time=0;if(event&128){while(true){var byte=this.data.getUint8(this.position++);time=time*128+(byte&127);if(!(byte&128))break}this.deltaTime=time;this.MLtime+=time}else this.deltaTime=0}this.wait=time*1/140;return true},refresh:function(){return this.wait},rewind:function(){if(this.Midi){this.midiFile=new this.Midi.File;this.midiTrack=new this.Midi.Track;this.midiFile.addTrack(this.midiTrack);this.midiTrack.setTempo(65);this.chanUsed=[]}this.position=this.scoreStart;this.deltaTime=0;this.playingcount=0;this.MLtime=0;this.OPLinit();this.OPLstopMusic();this.OPLplayMusic(127)},writeFrequency:function(slot,note,pitch,keyon){this.OPLwriteFreq(slot,note,pitch,keyon)},writeModulation:function(slot,instr,state){if(state)state=64;this.OPLwriteChannel(32,slot,instr.feedback&1?instr.modulatorTremolo|state:instr.modulatorTremolo,instr.carrierTremolo|state)},calcVolume:function(channelVolume,channelExpression,noteVolume){noteVolume=channelVolume*channelExpression*noteVolume/(127*127)|0;return noteVolume>127?127:noteVolume},occupyChannel:function(slot,channel,note,volume,instrument,secondary){var instr;var ch=this.channels[slot];ch.channel=channel;ch.note=note;ch.flags=secondary?this.CH_SECONDARY:0;if(this.driverdata.channelModulation[channel]>=this.MOD_MIN)ch.flags|=this.CH_VIBRATO;ch.time=this.MLtime;if(volume==-1)volume=this.driverdata.channelLastVolume[channel];else this.driverdata.channelLastVolume[channel]=volume;ch.realvolume=this.calcVolume(this.driverdata.channelVolume[channel],this.driverdata.channelExpression[channel],ch.volume=volume);if(instrument.fixedPitch)note=instrument.fixedNote;else if(channel==this.PERCUSSION)note=60;if(secondary&&instrument.doubleVoice)ch.finetune=instrument.fineTuning-128>>1;else ch.finetune=0;ch.pitch=ch.finetune+this.driverdata.channelPitch[channel];if(secondary)instr=instrument.voices[1];else instr=instrument.voices[0];ch.instr=instr;if(channel!=this.PERCUSSION&&!instrument.fixedPitch){if((note+=instr.baseNoteOffset)<0){while((note+=12)<0){}}else if(note>this.HIGHEST_NOTE){while((note-=12)>this.HIGHEST_NOTE){}}}ch.realnote=note;this.OPLwriteInstrument(slot,instr);if(ch.flags&this.CH_VIBRATO)this.writeModulation(slot,instr,1);this.OPLwritePan(slot,instr,this.driverdata.channelPan[channel]);this.OPLwriteVolume(slot,instr,ch.realvolume);this.writeFrequency(slot,note,ch.pitch,1);return slot},releaseChannel:function(slot,killed){var ch=this.channels[slot];this.writeFrequency(slot,ch.realnote,ch.pitch,0);ch.channel|=this.CH_FREE;ch.time=this.MLtime;ch.flags=this.CH_FREE;if(killed){this.OPLwriteChannel(128,slot,15,15);this.OPLwriteChannel(64,slot,63,63)}return slot},releaseSustain:function(channel){for(var i=0;i<this.OPLchannels;i++){if(this.channels[i].channel==channel&&this.channels[i].flags&this.CH_SUSTAIN){this.releaseChannel(i,0)}}return 0},findFreeChannel:function(flag,channel,note){var last=-1;var oldest=-1;var oldesttime=this.MLtime;var bestvoice=0;for(var i=0;i<this.OPLchannels;++i){if(++last==this.OPLchannels)last=0;if(this.channels[last].flags&this.CH_FREE)return last}if(flag&1){return-1}for(var i=0;i<this.OPLchannels;i++){if(this.channels[i].flags&this.CH_SECONDARY){this.releaseChannel(i,1);return i}else if(this.channels[i].time<oldesttime){oldesttime=this.channels[i].time;oldest=i}}if(!(flag&2)&&oldest!=-1){this.releaseChannel(oldest,1);return oldest}return-1},getInstrument:function(channel,note){var instrnumber;if(channel==this.PERCUSSION){if(note<35||note>81)return null;instrnumber=note+(128-35)}else{instrnumber=this.driverdata.channelInstr[channel]}return this.instruments[instrnumber]||null},OPLplayNote:function(channel,note,volume){if(volume==0)return this.OPLreleaseNote(channel,note);var instr=this.getInstrument(channel,note);if(!instr)return;var i=this.findFreeChannel(channel==this.PERCUSSION?2:0,channel,note);if(i>=0){this.occupyChannel(i,channel,note,volume,instr,0);if(instr.doubleVoice){i=this.findFreeChannel(channel==this.PERCUSSION?3:1,channel,note);if(i>=0){this.occupyChannel(i,channel,note,volume,instr,1)}}}},OPLreleaseNote:function(channel,note){var sustain=this.driverdata.channelSustain[channel];for(var i=0;i<this.OPLchannels;i++){if(this.channels[i].channel==channel&&this.channels[i].note==note){if(sustain<64)this.releaseChannel(i,0);else this.channels[i].flags|=this.CH_SUSTAIN}}},OPLpitchWheel:function(channel,pitch){pitch=(pitch-8192)*this.driverdata.channelPitchSens[channel]/(200*128)+64|0;this.driverdata.channelPitch[channel]=pitch;for(var i=0;i<this.OPLchannels;i++){var ch=this.channels[i];if(ch.channel==channel){ch.time=this.MLtime;ch.pitch=ch.finetune+pitch;this.writeFrequency(i,ch.realnote,ch.pitch,1)}}},OPLchangeControl:function(channel,controller,value){switch(controller){case this.MUSctrl.ctrlPatch:this.OPLprogramChange(channel,value);break;case this.MUSctrl.ctrlModulation:this.driverdata.channelModulation[channel]=value;for(var i=0;i<this.OPLchannels;i++){var ch=this.channels[i];if(ch.channel==channel){var flags=ch.flags;ch.time=this.MLtime;if(value>=this.MOD_MIN){ch.flags|=this.CH_VIBRATO;if(ch.flags!=flags)this.writeModulation(i,ch.instr,1)}else{ch.flags&=~this.CH_VIBRATO;if(ch.flags!=flags)this.writeModulation(i,ch.instr,0)}}}break;case this.MUSctrl.ctrlVolume:this.driverdata.channelVolume[channel]=value;case this.MUSctrl.ctrlExpression:if(controller==this.MUSctrl.ctrlExpression){this.driverdata.channelExpression[channel]=value}for(var i=0;i<this.OPLchannels;i++){var ch=this.channels[i];if(ch.channel==channel){ch.time=this.MLtime;ch.realvolume=this.calcVolume(this.driverdata.channelVolume[channel],this.driverdata.channelExpression[channel],ch.volume);this.OPLwriteVolume(i,ch.instr,ch.realvolume)}}break;case this.MUSctrl.ctrlPan:this.driverdata.channelPan[channel]=value-=64;for(var i=0;i<this.OPLchannels;i++){var ch=this.channels[i];if(ch.channel==channel){ch.time=this.MLtime;this.OPLwritePan(i,ch.instr,value)}}break;case this.MUSctrl.ctrlSustainPedal:this.driverdata.channelSustain[channel]=value;if(value<64)this.releaseSustain(channel);break;case this.MUSctrl.ctrlNotesOff:for(var i=0;i<this.OPLchannels;++i){if(this.channels[i].channel==channel){if(this.driverdata.channelSustain[channel]<64)this.releaseChannel(i,0);else this.channels[i].flags|=this.CH_SUSTAIN}}break;case this.MUSctrl.ctrlSoundsOff:for(var i=0;i<this.OPLchannels;++i){if(this.channels[i].channel==channel){this.releaseChannel(i,0)}}break;case this.MUSctrl.ctrlRPNHi:this.driverdata.channelRPN[channel]=this.driverdata.channelRPN[channel]&127|value<<7;break;case this.MUSctrl.ctrlRPNLo:this.driverdata.channelRPN[channel]=this.driverdata.channelRPN[channel]&16256|value;break;case this.MUSctrl.ctrlNRPNLo:case this.MUSctrl.ctrlNRPNHi:this.driverdata.channelRPN[channel]=16383;break;case this.MUSctrl.ctrlDataEntryHi:if(this.driverdata.channelRPN[channel]==0){this.driverdata.channelPitchSens[channel]=value*100+this.driverdata.channelPitchSens[channel]%100}break;case this.MUSctrl.ctrlDataEntryLo:if(this.driverdata.channelRPN[channel]==0){this.driverdata.channelPitchSens[channel]=value+Math.floor(this.driverdata.channelPitchSens[channel]/100)*100}break}},OPLprogramChange:function(channel,value){this.driverdata.channelInstr[channel]=value},OPLresetControllers:function(chan,vol){this.driverdata.channelVolume[chan]=vol;this.driverdata.channelExpression[chan]=127;this.driverdata.channelSustain[chan]=0;this.driverdata.channelLastVolume[chan]=64;this.driverdata.channelPitch[chan]=64;this.driverdata.channelRPN[chan]=16383;this.driverdata.channelPitchSens[chan]=200},OPLplayMusic:function(vol){for(var i=0;i<this.OPL3CHANNELS;i++){this.OPLresetControllers(i,vol)}},OPLstopMusic:function(){for(var i=0;i<this.OPLchannels;i++){if(!(this.channels[i].flags&this.CH_FREE)){this.releaseChannel(i,1)}}},OPLloadBank:function(data){},OPLwriteChannel:function(regbase,channel,data1,data2){var which=channel/this.OPL2CHANNELS|0;var reg=regbase+this.op_num[channel%this.OPL2CHANNELS];this.OPLwriteReg(which,reg,data1);this.OPLwriteReg(which,reg+3,data2)},OPLwriteValue:function(regbase,channel,value){var which=channel/this.OPL2CHANNELS|0;var reg=regbase+channel%this.OPL2CHANNELS;this.OPLwriteReg(which,reg,value)},OPLwriteFreq:function(channel,note,pitch,keyon){var octave=0;var j=(note<<5)+pitch;if(j<0)j=0;else if(j>=284){j-=284;octave=j/(32*12)|0;if(octave>7)octave=7;j=j%(32*12)+284}var i=this.frequencies[j]|octave<<10;this.OPLwriteValue(160,channel,i&255);this.OPLwriteValue(176,channel,i>>8|keyon<<5)},OPLconvertVolume:function(data,volume){return 63-((63-data)*this.volumetable[volume<=127?volume:127]>>7)},OPLpanVolume:function(volume,pan){return pan>=0?volume:volume*(pan+64)/64|0},OPLwriteVolume:function(channel,instr,volume){if(instr){this.OPLwriteChannel(64,channel,(instr.feedback&1?this.OPLconvertVolume(instr.modulatorOutput,volume):instr.modulatorOutput)|instr.modulatorKey,this.OPLconvertVolume(instr.carrierOutput,volume)|instr.carrierKey)}},OPLwritePan:function(channel,instr,pan){if(instr){var bits;if(pan<-36)bits=16;else if(pan>36)bits=32;else bits=48;this.OPLwriteValue(192,channel,instr.feedback|bits)}},OPLwriteInstrument:function(channel,instr){this.OPLwriteChannel(64,channel,63,63);this.OPLwriteChannel(32,channel,instr.modulatorTremolo,instr.carrierTremolo);this.OPLwriteChannel(96,channel,instr.modulatorAttack,instr.carrierAttack);this.OPLwriteChannel(128,channel,instr.modulatorSustain,instr.carrierSustain);this.OPLwriteChannel(224,channel,instr.modulatorWaveform,instr.carrierWaveform);this.OPLwriteValue(192,channel,instr.feedback|48)},OPLshutup:function(){for(i=0;i<this.OPL3CHANNELS;i++){this.OPLwriteChannel(64,i,63,63);this.OPLwriteChannel(96,i,255,255);this.OPLwriteChannel(128,i,15,15);this.OPLwriteValue(176,i,0)}},OPLwriteInitState:function(initopl3){this.OPLwriteReg(1,261,1);this.OPLwriteReg(1,260,0);this.OPLwriteReg(0,1,32);this.OPLwriteReg(0,8,64);this.OPLwriteReg(0,189,0);this.OPLshutup()},OPLinit:function(numchips,stereo,initopl3){this.OPLwriteInitState(true)},OPLdeinit:function(){},OPLwriteReg:function(which,reg,data){if(this.onlyMidi)return;if(which==1&&reg>256)reg-=256;this.opl.write(which,reg,data)},volumetable:[0,1,3,5,6,8,10,11,13,14,16,17,19,20,22,23,25,26,27,29,30,32,33,34,36,37,39,41,43,45,47,49,50,52,54,55,57,59,60,61,63,64,66,67,68,69,71,72,73,74,75,76,77,79,80,81,82,83,84,84,85,86,87,88,89,90,91,92,92,93,94,95,96,96,97,98,99,99,100,101,101,102,103,103,104,105,105,106,107,107,108,109,109,110,110,111,112,112,113,113,114,114,115,115,116,117,117,118,118,119,119,120,120,121,121,122,122,123,123,123,124,124,125,125,126,126,127,127],frequencies:[307,307,308,308,309,310,310,311,311,312,312,313,313,314,315,315,316,316,317,317,318,319,319,320,320,321,322,322,323,323,324,324,325,326,326,327,327,328,329,329,330,330,331,332,332,333,333,334,335,335,336,336,337,338,338,339,339,340,341,341,342,343,343,344,344,345,346,346,347,347,348,349,349,350,351,351,352,353,353,354,354,355,356,356,357,358,358,359,360,360,361,362,362,363,364,364,365,366,366,367,368,368,369,370,370,371,372,372,373,374,374,375,376,376,377,378,378,379,380,380,381,382,382,383,384,385,385,386,387,387,388,389,389,390,391,392,392,393,394,394,395,396,397,397,398,399,399,400,401,402,402,403,404,404,405,406,407,407,408,409,410,410,411,412,413,413,414,415,416,416,417,418,419,419,420,421,422,422,423,424,425,425,426,427,428,429,429,430,431,432,432,433,434,435,436,436,437,438,439,440,440,441,442,443,444,444,445,446,447,448,448,449,450,451,452,452,453,454,455,456,457,457,458,459,460,461,462,462,463,464,465,466,467,467,468,469,470,471,472,472,473,474,475,476,477,478,478,479,480,481,482,483,484,485,485,486,487,488,489,490,491,492,493,493,494,495,496,497,498,499,500,501,502,502,503,504,505,506,507,508,509,510,511,512,513,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,598,599,600,601,602,603,604,605,606,607,608,610,611,612,613,614,615,616,617,618,620,621,622,623,624,625,626,627,629,630,631,632,633,634,635,637,638,639,640,641,642,644,645,646,647,648,649,651,652,653,654,655,656,658,659,660,661,662,664,665,666,667,668,670,671,672,673,674,676,677,678,679,681,682,683,684,686,687,688,689,690,692,693,694,695,697,698,699,701,702,703,704,706,707,708,709,711,712,713,715,716,717,718,720,721,722,724,725,726,728,729,730,732,733,734,736,737,738,740,741,742,744,745,746,748,749,750,752,753,754,756,757,758,760,761,763,764,765,767,768,770,771,772,774,775,777,778,779,781,782,784,785,786,788,789,791,792,794,795,796,798,799,801,802,804,805,807,808,809,811,812,814,815,817,818,820,821,823,824,826,827,829,830,832,833,835,836,838,839,841,842,844,845,847,848,850,851,853,855,856,858,859,861,862,864,865,867,869,870,872,873,875,876,878,880,881,883,884,886,888,889,891,892,894,896,897,899,900,902,904,905,907,909,910,912,914,915,917,919,920,922,924,925,927,929,930,932,934,935,937,939,940,942,944,945,947,949,951,952,954,956,957,959,961,963,964,966,968,970,971,973,975,977,978,980,982,984,986,987,989,991,993,995,996,998,1e3,1002,1004,1005,1007,1009,1011,1013,1014,1016,1018,1020,1022,876]})},{"./genmidi.json":2,extend:21,"wad-genmidi":48}],6:[function(_dereq_,module,exports){(function(Buffer){var extend=_dereq_("extend");function RAW(opl){this.opl=opl}module.exports=RAW;extend(RAW.prototype,{load:function(buffer){var header=new Buffer(buffer.buffer).slice(0,8).toString();if(header!="RAWADATA")throw new Error('Buffer is not a "Rdos Raw OPL Capture" file');this.data=new DataView(buffer.buffer);this.clock=this.data.getUint16(8,true);this.rewind()},update:function(){this.delay=0;while(!this.songend&&!this.delay&&this.position<this.data.byteLength){var value=this.data.getUint8(this.position++);var reg=this.data.getUint8(this.position++);switch(reg){case 255:if(value==255)this.songend=true;break;case 0:this.delay=value||255;break;case 2:switch(value){case 0:this.clock=this.data.getUint16(this.position,true);this.position+=2;break;case 1:this.bank=0;break;case 2:this.bank=1;break}break;default:this.midi_write_adlib(reg,value)}}return!this.songend&&this.delay},rewind:function(){this.songend=false;this.delay=0;this.position=10;this.bank=0;this.opl.write(1,32)},refresh:function(){return this.delay/(1193180/(this.clock||65535))},midi_write_adlib:function(r,v){this.opl.write(this.bank,r,v)}})}).call(this,_dereq_("buffer").Buffer)},{buffer:16,extend:21}],7:[function(_dereq_,module,exports){module.exports={OPL3:_dereq_("./lib/opl3"),format:{LAA:_dereq_("./format/laa"),MUS:_dereq_("./format/mus"),DRO:_dereq_("./format/dro"),IMF:_dereq_("./format/imf"),RAW:_dereq_("./format/raw")},WAV:_dereq_("./lib/wav"),ConvertTo32Bit:_dereq_("./lib/convertto32bit"),Normalizer:_dereq_("./lib/normalizer"),Player:_dereq_("./lib/player")}},{"./format/dro":1,"./format/imf":3,"./format/laa":4,"./format/mus":5,"./format/raw":6,"./lib/convertto32bit":8,"./lib/normalizer":9,"./lib/opl3":10,"./lib/player":11,"./lib/wav":12}],8:[function(_dereq_,module,exports){(function(Buffer){var Transform=_dereq_("stream").Transform;var util=_dereq_("util");function ConvertTo32Bit(){Transform.call(this)}ConvertTo32Bit.prototype._transform=function(chunk,encoding,done){var b32=new Float32Array(chunk.byteLength/2);var dv=new DataView(chunk.buffer);for(var i=0,offset=0;offset<chunk.byteLength;i++,offset+=2){b32[i]=dv.getInt16(offset,true)/32768}done(null,new Buffer(b32.buffer))};util.inherits(ConvertTo32Bit,Transform);module.exports=ConvertTo32Bit}).call(this,_dereq_("buffer").Buffer)},{buffer:16,stream:28,util:47}],9:[function(_dereq_,module,exports){var Transform=_dereq_("stream").Transform;var WritableStreamBuffer=_dereq_("stream-buffers").WritableStreamBuffer;var util=_dereq_("util");function Normalizer(bitDepth){Transform.call(this);var self=this;var WritableStreamBuffer=_dereq_("stream-buffers").WritableStreamBuffer;var writer=new WritableStreamBuffer({initialSize:1024*1024,incrementAmount:512*1024});var peak=0;var scale=1;var targetPeak=bitDepth==32?1:32768;var len=0;var bps=bitDepth==32?4:2;var getter=bitDepth==32?DataView.prototype.getFloat32:DataView.prototype.getInt16;var setter=bitDepth==32?DataView.prototype.setFloat32:DataView.prototype.setInt16;this._transform=function(chunk,encoding,done){var dv=new DataView(chunk.buffer);len+=chunk.byteLength/bps;for(var i=0;i<chunk.byteLength;i+=bps){var p=Math.abs(getter.call(dv,i,true));if(p>peak)peak=p}writer.write(chunk);done()};this._flush=function(done){writer.end();var pcmBuffer=writer.getContents();var endFn=function(){self.push(pcmBuffer);done()};if(peak>0){scale=targetPeak/peak;var dv=new DataView(pcmBuffer.buffer);var i=0;var perc=0;var normPcm=function(){var t=Date.now();for(;i<pcmBuffer.byteLength;i+=bps){setter.call(dv,i,Math.round(getter.call(dv,i,true)*scale),true);var p=Math.floor(i/pcmBuffer.byteLength*1e3)/10;if(p>perc){perc=p;self.emit("normalization",perc)}if(Date.now()-t>1e3)return setImmediate(normPcm)}self.emit("normalization",100);self.emit("gain",scale);endFn()};normPcm()}else endFn()}}util.inherits(Normalizer,Transform);module.exports=Normalizer},{stream:28,"stream-buffers":42,util:47}],10:[function(_dereq_,module,exports){var util=_dereq_("util");var extend=_dereq_("extend");function OPL3(){this.nts=0;this.dam=0;this.dvb=0;this.ryt=0;this.bd=0;this.sd=0;this.tom=0;this.tc=0;this.hh=0;this._new=0;this.connectionsel=0;this.vibratoIndex=0;this.tremoloIndex=0;this.registers=new Int32Array(512);this.channels=[new Array(9),new Array(9)];this.initOperators();this.initChannels2op();this.initChannels4op();this.initRhythmChannels();this.initChannels();this.output=new Int16Array(2);this.outputBuffer=new Float64Array(4);this.outputChannelNumber=2}module.exports=OPL3;extend(OPL3.prototype,{read:function(output,seek){var offset=seek||0;output=output||this.output;var converterScale=output instanceof Float32Array?32768:1;do{var channelOutput;for(var outputChannelNumber=0;outputChannelNumber<4;outputChannelNumber++){this.outputBuffer[outputChannelNumber]=0}for(var array=0;array<this._new+1;array++){for(var channelNumber=0;channelNumber<9;channelNumber++){channelOutput=this.channels[array][channelNumber].getChannelOutput();for(var outputChannelNumber=0;outputChannelNumber<4;outputChannelNumber++){this.outputBuffer[outputChannelNumber]+=channelOutput[outputChannelNumber]}}}for(var outputChannelNumber=0;outputChannelNumber<this.outputChannelNumber;outputChannelNumber++){output[offset+outputChannelNumber]=this.outputBuffer[outputChannelNumber]/18*32767/converterScale}this.vibratoIndex++;if(this.vibratoIndex>=OPL3Data.vibratoTable[this.dvb].length)this.vibratoIndex=0;this.tremoloIndex++;if(this.tremoloIndex>=OPL3Data.tremoloTable[this.dam].length)this.tremoloIndex=0;offset+=this.outputChannelNumber}while(offset<output.length);return output},write:function(array,address,data){var registerAddress=array<<8|address;if(registerAddress<0||registerAddress>=512)return;this.registers[registerAddress]=data;switch(address&224){case 0:if(array==1){if(address==4)this.update_2_CONNECTIONSEL6();else if(address==5){this.update_7_NEW1()}}else if(address==8)this.update_1_NTS1_6();break;case 160:if(address==189){if(array==0)this.update_DAM1_DVB1_RYT1_BD1_SD1_TOM1_TC1_HH1();break}if((address&240)==176&&address<=184){this.channels[array][address&15].update_2_KON1_BLOCK3_FNUMH2();break}if((address&240)==160&&address<=168)this.channels[array][address&15].update_FNUML8();break;case 192:if(address<=200)this.channels[array][address&15].update_CHD1_CHC1_CHB1_CHA1_FB3_CNT1();break;default:var operatorOffset=address&31;if(!this.operators[array][operatorOffset])break;switch(address&224){case 32:this.operators[array][operatorOffset].update_AM1_VIB1_EGT1_KSR1_MULT4();break;case 64:this.operators[array][operatorOffset].update_KSL2_TL6();break;case 96:this.operators[array][operatorOffset].update_AR4_DR4();break;case 128:this.operators[array][operatorOffset].update_SL4_RR4();break;case 224:this.operators[array][operatorOffset].update_5_WS3()}}},initOperators:function(){this.operators=[[],[]];for(var array=0;array<2;array++){for(var group=0;group<=16;group+=8){for(var offset=0;offset<6;offset++){var baseAddress=array<<8|group+offset;this.operators[array][group+offset]=new Operator(baseAddress,this)}}}this.highHatOperator=new HighHatOperator(this);this.snareDrumOperator=new SnareDrumOperator(this);this.tomTomOperator=new TomTomOperator(this);this.topCymbalOperator=new TopCymbalOperator(this);this.highHatOperatorInNonRhythmMode=this.operators[0][17];this.snareDrumOperatorInNonRhythmMode=this.operators[0][20];this.tomTomOperatorInNonRhythmMode=this.operators[0][18];this.topCymbalOperatorInNonRhythmMode=this.operators[0][21]},initChannels2op:function(){this.channels2op=[[],[]];for(var array=0;array<2;array++){for(var channelNumber=0;channelNumber<3;channelNumber++){var baseAddress=array<<8|channelNumber;this.channels2op[array][channelNumber]=new Channel2op(baseAddress,this.operators[array][channelNumber],this.operators[array][channelNumber+3],this);this.channels2op[array][channelNumber+3]=new Channel2op(baseAddress+3,this.operators[array][channelNumber+8],this.operators[array][channelNumber+11],this);this.channels2op[array][channelNumber+6]=new Channel2op(baseAddress+6,this.operators[array][channelNumber+16],this.operators[array][channelNumber+19],this)}}},initChannels4op:function(){this.channels4op=[[],[]];for(var array=0;array<2;array++){for(var channelNumber=0;channelNumber<3;channelNumber++){var baseAddress=array<<8|channelNumber;this.channels4op[array][channelNumber]=new Channel4op(baseAddress,this.operators[array][channelNumber],this.operators[array][channelNumber+3],this.operators[array][channelNumber+8],this.operators[array][channelNumber+11],this)}}},initRhythmChannels:function(){this.bassDrumChannel=new BassDrumChannel(this);this.highHatSnareDrumChannel=new HighHatSnareDrumChannel(this);this.tomTomTopCymbalChannel=new TomTomTopCymbalChannel(this)},initChannels:function(){for(var array=0;array<2;array++){for(var i=0;i<9;i++)this.channels[array][i]=this.channels2op[array][i]}this.disabledChannel=new DisabledChannel(this)},update_1_NTS1_6:function(){var _1_nts1_6=this.registers[OPL3Data._1_NTS1_6_Offset];this.nts=(_1_nts1_6&64)>>6},update_DAM1_DVB1_RYT1_BD1_SD1_TOM1_TC1_HH1:function(){var dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1=this.registers[OPL3Data.DAM1_DVB1_RYT1_BD1_SD1_TOM1_TC1_HH1_Offset];this.dam=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&128)>>7;this.dvb=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&64)>>6;var new_ryt=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&32)>>5;if(new_ryt!=this.ryt){this.ryt=new_ryt;this.setRhythmMode()}var new_bd=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&16)>>4;if(new_bd!=this.bd){this.bd=new_bd;if(this.bd==1){this.bassDrumChannel.op1.keyOn();this.bassDrumChannel.op2.keyOn()}}var new_sd=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&8)>>3;if(new_sd!=this.sd){this.sd=new_sd;if(this.sd==1)this.snareDrumOperator.keyOn()}var new_tom=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&4)>>2;if(new_tom!=this.tom){this.tom=new_tom;if(this.tom==1)this.tomTomOperator.keyOn()}var new_tc=(dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&2)>>1;if(new_tc!=this.tc){this.tc=new_tc;if(this.tc==1)this.topCymbalOperator.keyOn()}var new_hh=dam1_dvb1_ryt1_bd1_sd1_tom1_tc1_hh1&1;if(new_hh!=this.hh){this.hh=new_hh;if(this.hh==1)this.highHatOperator.keyOn()}},update_7_NEW1:function(){var _7_new1=this.registers[OPL3Data._7_NEW1_Offset];this._new=_7_new1&1;if(this._new==1)this.setEnabledChannels();this.set4opConnections()},setEnabledChannels:function(){for(var array=0;array<2;array++){for(var i=0;i<9;i++){var baseAddress=this.channels[array][i].channelBaseAddress;this.registers[baseAddress+ChannelData.CHD1_CHC1_CHB1_CHA1_FB3_CNT1_Offset]|=240;this.channels[array][i].update_CHD1_CHC1_CHB1_CHA1_FB3_CNT1()}}},update_2_CONNECTIONSEL6:function(){var _2_connectionsel6=this.registers[OPL3Data._2_CONNECTIONSEL6_Offset];this.connectionsel=_2_connectionsel6&63;this.set4opConnections()},set4opConnections:function(){for(var array=0;array<2;++array){for(var i=0;i<3;++i){if(this._new==1){var shift=array*3+i;var connectionBit=this.connectionsel>>shift&1;if(connectionBit==1){this.channels[array][i]=this.channels4op[array][i];this.channels[array][i+3]=this.disabledChannel;this.channels[array][i].updateChannel();continue}}this.channels[array][i]=this.channels2op[array][i];this.channels[array][i+3]=this.channels2op[array][i+3];this.channels[array][i].updateChannel();this.channels[array][i+3].updateChannel()}}},setRhythmMode:function(){if(this.ryt==1){this.channels[0][6]=this.bassDrumChannel;this.channels[0][7]=this.highHatSnareDrumChannel;this.channels[0][8]=this.tomTomTopCymbalChannel;this.operators[0][17]=this.highHatOperator;this.operators[0][20]=this.snareDrumOperator;this.operators[0][18]=this.tomTomOperator;this.operators[0][21]=this.topCymbalOperator}else{for(var i=6;i<=8;i++)this.channels[0][i]=this.channels2op[0][i];this.operators[0][17]=this.highHatOperatorInNonRhythmMode;this.operators[0][20]=this.snareDrumOperatorInNonRhythmMode;this.operators[0][18]=this.tomTomOperatorInNonRhythmMode;this.operators[0][21]=this.topCymbalOperatorInNonRhythmMode}for(var i=6;i<=8;i++)this.channels[0][i].updateChannel()}});function Channel(baseAddress,opl){this.opl=opl;this.channelBaseAddress=baseAddress;this.fnuml=0;this.fnumh=0;this.kon=0;this.block=0;this.cha=0;this.chb=0;this.chc=0;this.chd=0;this.fb=0;this.cnt=0;this.feedback=[0,0];this.toPhase=4;this.output=new Float64Array(4)}extend(Channel.prototype,{update_2_KON1_BLOCK3_FNUMH2:function(){var _2_kon1_block3_fnumh2=this.opl.registers[this.channelBaseAddress+ChannelData._2_KON1_BLOCK3_FNUMH2_Offset];this.block=(_2_kon1_block3_fnumh2&28)>>2;this.fnumh=_2_kon1_block3_fnumh2&3;this.updateOperators();var newKon=(_2_kon1_block3_fnumh2&32)>>5;if(newKon!=this.kon){if(newKon==1)this.keyOn();else this.keyOff();this.kon=newKon}},update_FNUML8:function(){var fnuml8=this.opl.registers[this.channelBaseAddress+ChannelData.FNUML8_Offset];this.fnuml=fnuml8&255;this.updateOperators()},update_CHD1_CHC1_CHB1_CHA1_FB3_CNT1:function(){var chd1_chc1_chb1_cha1_fb3_cnt1=this.opl.registers[this.channelBaseAddress+ChannelData.CHD1_CHC1_CHB1_CHA1_FB3_CNT1_Offset];this.chd=(chd1_chc1_chb1_cha1_fb3_cnt1&128)>>7;this.chc=(chd1_chc1_chb1_cha1_fb3_cnt1&64)>>6;this.chb=(chd1_chc1_chb1_cha1_fb3_cnt1&32)>>5;this.cha=(chd1_chc1_chb1_cha1_fb3_cnt1&16)>>4;this.fb=(chd1_chc1_chb1_cha1_fb3_cnt1&14)>>1;this.cnt=chd1_chc1_chb1_cha1_fb3_cnt1&1;this.updateOperators()},updateChannel:function(){this.update_2_KON1_BLOCK3_FNUMH2();this.update_FNUML8();this.update_CHD1_CHC1_CHB1_CHA1_FB3_CNT1()},getInFourChannels:function(channelOutput){if(this.opl._new==0){this.output[0]=this.output[1]=this.output[2]=this.output[3]=channelOutput}else{this.output[0]=this.cha==1?channelOutput:0;this.output[1]=this.chb==1?channelOutput:0;this.output[2]=this.chc==1?channelOutput:0;this.output[3]=this.chd==1?channelOutput:0}return this.output}});function Channel2op(baseAddress,o1,o2,opl){Channel.call(this,baseAddress,opl);this.op1=o1;this.op2=o2}util.inherits(Channel2op,Channel);Channel2op.prototype.getChannelOutput=function(){var channelOutput=0,op1Output=0,op2Output=0;var feedbackOutput=(this.feedback[0]+this.feedback[1])/2;if(this.cnt==0){if(this.op2.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return this.getInFourChannels(0);op1Output=this.op1.getOperatorOutput(feedbackOutput);channelOutput=this.op2.getOperatorOutput(op1Output*this.toPhase)}else{if(this.op1.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF&&this.op2.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return this.getInFourChannels(0);op1Output=this.op1.getOperatorOutput(feedbackOutput);op2Output=this.op2.getOperatorOutput(Operator.noModulator);channelOutput=(op1Output+op2Output)/2}this.feedback[0]=this.feedback[1];this.feedback[1]=op1Output*ChannelData.feedback[this.fb]%1;return this.getInFourChannels(channelOutput)};Channel2op.prototype.keyOn=function(){this.op1.keyOn();this.op2.keyOn();
this.feedback[0]=this.feedback[1]=0};Channel2op.prototype.keyOff=function(){this.op1.keyOff();this.op2.keyOff()};Channel2op.prototype.updateOperators=function(){var keyScaleNumber=this.block*2+(this.fnumh>>this.opl.nts&1);var f_number=this.fnumh<<8|this.fnuml;this.op1.updateOperator(keyScaleNumber,f_number,this.block);this.op2.updateOperator(keyScaleNumber,f_number,this.block)};function Channel4op(baseAddress,o1,o2,o3,o4,opl){Channel.call(this,baseAddress,opl);this.op1=o1;this.op2=o2;this.op3=o3;this.op4=o4}util.inherits(Channel4op,Channel);Channel4op.prototype.getChannelOutput=function(){var channelOutput=0,op1Output=0,op2Output=0,op3Output=0,op4Output=0;var secondChannelBaseAddress=this.channelBaseAddress+3;var secondCnt=this.opl.registers[secondChannelBaseAddress+ChannelData.CHD1_CHC1_CHB1_CHA1_FB3_CNT1_Offset]&1;var cnt4op=this.cnt<<1|secondCnt;var feedbackOutput=(this.feedback[0]+this.feedback[1])/2;switch(cnt4op){case 0:if(this.op4.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return this.getInFourChannels(0);op1Output=this.op1.getOperatorOutput(feedbackOutput);op2Output=this.op2.getOperatorOutput(op1Output*this.toPhase);op3Output=this.op3.getOperatorOutput(op2Output*this.toPhase);channelOutput=this.op4.getOperatorOutput(op3Output*this.toPhase);break;case 1:if(this.op2.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF&&this.op4.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return this.getInFourChannels(0);op1Output=this.op1.getOperatorOutput(feedbackOutput);op2Output=this.op2.getOperatorOutput(op1Output*this.toPhase);op3Output=this.op3.getOperatorOutput(Operator.noModulator);op4Output=this.op4.getOperatorOutput(op3Output*this.toPhase);channelOutput=(op2Output+op4Output)/2;break;case 2:if(this.op1.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF&&this.op4.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return this.getInFourChannels(0);op1Output=this.op1.getOperatorOutput(feedbackOutput);op2Output=this.op2.getOperatorOutput(Operator.noModulator);op3Output=this.op3.getOperatorOutput(op2Output*this.toPhase);op4Output=this.op4.getOperatorOutput(op3Output*this.toPhase);channelOutput=(op1Output+op4Output)/2;break;case 3:if(this.op1.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF&&this.op3.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF&&this.op4.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return this.getInFourChannels(0);op1Output=this.op1.getOperatorOutput(feedbackOutput);op2Output=this.op2.getOperatorOutput(Operator.noModulator);op3Output=this.op3.getOperatorOutput(op2Output*this.toPhase);op4Output=this.op4.getOperatorOutput(Operator.noModulator);channelOutput=(op1Output+op3Output+op4Output)/3;break}this.feedback[0]=this.feedback[1];this.feedback[1]=op1Output*ChannelData.feedback[this.fb]%1;return this.getInFourChannels(channelOutput)};Channel4op.prototype.keyOn=function(){this.op1.keyOn();this.op2.keyOn();this.op3.keyOn();this.op4.keyOn();this.feedback[0]=this.feedback[1]=0};Channel4op.prototype.keyOff=function(){this.op1.keyOff();this.op2.keyOff();this.op3.keyOff();this.op4.keyOff()};Channel4op.prototype.updateOperators=function(){var keyScaleNumber=this.block*2+(this.fnumh>>this.opl.nts&1);var f_number=this.fnumh<<8|this.fnuml;this.op1.updateOperator(keyScaleNumber,f_number,this.block);this.op2.updateOperator(keyScaleNumber,f_number,this.block);this.op3.updateOperator(keyScaleNumber,f_number,this.block);this.op4.updateOperator(keyScaleNumber,f_number,this.block)};function DisabledChannel(opl){Channel.call(this,0,opl);this.opl=opl}util.inherits(DisabledChannel,Channel);DisabledChannel.prototype.getChannelOutput=function(){return this.getInFourChannels(0)};DisabledChannel.prototype.keyOn=function(){};DisabledChannel.prototype.keyOff=function(){};DisabledChannel.prototype.updateOperators=function(){};function Operator(baseAddress,opl){this.opl=opl;this.operatorBaseAddress=baseAddress;this.phaseGenerator=new PhaseGenerator(opl);this.envelopeGenerator=new EnvelopeGenerator(opl);this.envelope=0;this.am=0;this.vib=0;this.ksr=0;this.egt=0;this.mult=0;this.ksl=0;this.tl=0;this.ar=0;this.dr=0;this.sl=0;this.rr=0;this.ws=0;this.keyScaleNumber=0;this.f_number=0;this.block=0}Operator.noModulator=0;extend(Operator.prototype,{update_AM1_VIB1_EGT1_KSR1_MULT4:function(){var am1_vib1_egt1_ksr1_mult4=this.opl.registers[this.operatorBaseAddress+OperatorData.AM1_VIB1_EGT1_KSR1_MULT4_Offset];this.am=(am1_vib1_egt1_ksr1_mult4&128)>>7;this.vib=(am1_vib1_egt1_ksr1_mult4&64)>>6;this.egt=(am1_vib1_egt1_ksr1_mult4&32)>>5;this.ksr=(am1_vib1_egt1_ksr1_mult4&16)>>4;this.mult=am1_vib1_egt1_ksr1_mult4&15;this.phaseGenerator.setFrequency(this.f_number,this.block,this.mult);this.envelopeGenerator.setActualAttackRate(this.ar,this.ksr,this.keyScaleNumber);this.envelopeGenerator.setActualDecayRate(this.dr,this.ksr,this.keyScaleNumber);this.envelopeGenerator.setActualReleaseRate(this.rr,this.ksr,this.keyScaleNumber)},update_KSL2_TL6:function(){var ksl2_tl6=this.opl.registers[this.operatorBaseAddress+OperatorData.KSL2_TL6_Offset];this.ksl=(ksl2_tl6&192)>>6;this.tl=ksl2_tl6&63;this.envelopeGenerator.setAtennuation(this.f_number,this.block,this.ksl);this.envelopeGenerator.setTotalLevel(this.tl)},update_AR4_DR4:function(){var ar4_dr4=this.opl.registers[this.operatorBaseAddress+OperatorData.AR4_DR4_Offset];this.ar=(ar4_dr4&240)>>4;this.dr=ar4_dr4&15;this.envelopeGenerator.setActualAttackRate(this.ar,this.ksr,this.keyScaleNumber);this.envelopeGenerator.setActualDecayRate(this.dr,this.ksr,this.keyScaleNumber)},update_SL4_RR4:function(){var sl4_rr4=this.opl.registers[this.operatorBaseAddress+OperatorData.SL4_RR4_Offset];this.sl=(sl4_rr4&240)>>4;this.rr=sl4_rr4&15;this.envelopeGenerator.setActualSustainLevel(this.sl);this.envelopeGenerator.setActualReleaseRate(this.rr,this.ksr,this.keyScaleNumber)},update_5_WS3:function(){var _5_ws3=this.opl.registers[this.operatorBaseAddress+OperatorData._5_WS3_Offset];this.ws=_5_ws3&7},getOperatorOutput:function(modulator){if(this.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return 0;var envelopeInDB=this.envelopeGenerator.getEnvelope(this.egt,this.am);this.envelope=Math.pow(10,envelopeInDB/10);this.ws=this.ws&(this.opl._new<<2)+3;var waveform=OperatorData.waveforms[this.ws];this.phase=this.phaseGenerator.getPhase(this.vib);return this.getOutput(modulator,this.phase,waveform)},getOutput:function(modulator,outputPhase,waveform){outputPhase=(outputPhase+modulator)%1;if(outputPhase<0){outputPhase++;outputPhase%=1}var sampleIndex=outputPhase*OperatorData.waveLength|0;return waveform[sampleIndex]*this.envelope},keyOn:function(){if(this.ar>0){this.envelopeGenerator.keyOn();this.phaseGenerator.keyOn()}else this.envelopeGenerator.stage=EnvelopeGenerator.Stage.OFF},keyOff:function(){this.envelopeGenerator.keyOff()},updateOperator:function(ksn,f_num,blk){this.keyScaleNumber=ksn;this.f_number=f_num;this.block=blk;this.update_AM1_VIB1_EGT1_KSR1_MULT4();this.update_KSL2_TL6();this.update_AR4_DR4();this.update_SL4_RR4();this.update_5_WS3()}});function EnvelopeGenerator(opl){this.opl=opl;this.stage=EnvelopeGenerator.Stage.OFF;this.actualAttackRate=0;this.actualDecayRate=0;this.actualReleaseRate=0;this.xAttackIncrement=0;this.xMinimumInAttack=0;this.dBdecayIncrement=0;this.dBreleaseIncrement=0;this.attenuation=0;this.totalLevel=0;this.sustainLevel=0;this.x=this.dBtoX(-96);this.resolutionMaximum=this.dBtoX(-.1875);this.percentage10=this.percentageToX(.1);this.percentage90=this.percentageToX(.9);this.envelope=-96}EnvelopeGenerator.Stage={ATTACK:"ATTACK",DECAY:"DECAY",SUSTAIN:"SUSTAIN",RELEASE:"RELEASE",OFF:"OFF"};extend(EnvelopeGenerator.prototype,{setActualSustainLevel:function(sl){if(sl==15){this.sustainLevel=-93;return}this.sustainLevel=-3*sl},setTotalLevel:function(tl){this.totalLevel=tl*-.75},setAtennuation:function(f_number,block,ksl){var hi4bits=f_number>>6&15;switch(ksl){case 0:this.attenuation=0;break;case 1:this.attenuation=OperatorData.ksl3dBtable[hi4bits][block];break;case 2:this.attenuation=OperatorData.ksl3dBtable[hi4bits][block]/2;break;case 3:this.attenuation=OperatorData.ksl3dBtable[hi4bits][block]*2}},setActualAttackRate:function(attackRate,ksr,keyScaleNumber){this.actualAttackRate=this.calculateActualRate(attackRate,ksr,keyScaleNumber)|0;var period0to100inSeconds=EnvelopeGeneratorData.attackTimeValuesTable[this.actualAttackRate][0]/1e3;var period0to100inSamples=period0to100inSeconds*OPL3Data.sampleRate|0;var period10to90inSeconds=EnvelopeGeneratorData.attackTimeValuesTable[this.actualAttackRate][1]/1e3;var period10to90inSamples=period10to90inSeconds*OPL3Data.sampleRate|0;this.xAttackIncrement=OPL3Data.calculateIncrement(this.percentage10,this.percentage90,period10to90inSeconds);var period10to100inSamples=period10to90inSamples+(this.resolutionMaximum-this.percentage90)/this.xAttackIncrement|0;this.xMinimumInAttack=this.percentage10-(period0to100inSamples-period10to100inSamples)*this.xAttackIncrement},setActualDecayRate:function(decayRate,ksr,keyScaleNumber){this.actualDecayRate=this.calculateActualRate(decayRate,ksr,keyScaleNumber)|0;var period10to90inSeconds=EnvelopeGeneratorData.decayAndReleaseTimeValuesTable[this.actualDecayRate][1]/1e3;this.dBdecayIncrement=OPL3Data.calculateIncrement(this.percentageToDB(.1),this.percentageToDB(.9),period10to90inSeconds)},setActualReleaseRate:function(releaseRate,ksr,keyScaleNumber){this.actualReleaseRate=this.calculateActualRate(releaseRate,ksr,keyScaleNumber)|0;var period10to90inSeconds=EnvelopeGeneratorData.decayAndReleaseTimeValuesTable[this.actualReleaseRate][1]/1e3;this.dBreleaseIncrement=OPL3Data.calculateIncrement(this.percentageToDB(.1),this.percentageToDB(.9),period10to90inSeconds)},calculateActualRate:function(rate,ksr,keyScaleNumber){var rof=EnvelopeGeneratorData.rateOffset[ksr][keyScaleNumber];var actualRate=rate*4+rof;if(actualRate>63)actualRate=63;return actualRate},getEnvelope:function(egt,am){var envelopeSustainLevel=this.sustainLevel/2;var envelopeTremolo=OPL3Data.tremoloTable[this.opl.dam][this.opl.tremoloIndex]/2;var envelopeAttenuation=this.attenuation/2;var envelopeTotalLevel=this.totalLevel/2;var envelopeMinimum=-96;var envelopeResolution=.1875;var outputEnvelope;switch(this.stage){case EnvelopeGenerator.Stage.ATTACK:if(this.envelope<-envelopeResolution&&this.xAttackIncrement!=-Infinity){this.envelope=-Math.pow(2,this.x);this.x+=this.xAttackIncrement;break}else{this.envelope=0;this.stage=EnvelopeGenerator.Stage.DECAY}case EnvelopeGenerator.Stage.DECAY:if(this.envelope>envelopeSustainLevel){this.envelope-=this.dBdecayIncrement;break}else this.stage=EnvelopeGenerator.Stage.SUSTAIN;case EnvelopeGenerator.Stage.SUSTAIN:if(egt==1)break;else{if(this.envelope>envelopeMinimum)this.envelope-=this.dBreleaseIncrement;else this.stage=EnvelopeGenerator.Stage.OFF}break;case EnvelopeGenerator.Stage.RELEASE:if(this.envelope>envelopeMinimum)this.envelope-=this.dBreleaseIncrement;else this.stage=EnvelopeGenerator.Stage.OFF}outputEnvelope=this.envelope;if(am==1)outputEnvelope+=envelopeTremolo;outputEnvelope+=envelopeAttenuation;outputEnvelope+=envelopeTotalLevel;return outputEnvelope},keyOn:function(){var xCurrent=Math.log2(-this.envelope);this.x=xCurrent<this.xMinimumInAttack?xCurrent:this.xMinimumInAttack;this.stage=EnvelopeGenerator.Stage.ATTACK},keyOff:function(){if(this.stage!=EnvelopeGenerator.Stage.OFF)this.stage=EnvelopeGenerator.Stage.RELEASE},dBtoX:function(dB){return Math.log2(-dB)},percentageToDB:function(percentage){return Math.log10(percentage)*10},percentageToX:function(percentage){return this.dBtoX(this.percentageToDB(percentage))}});function PhaseGenerator(opl){this.opl=opl;this.phase=0;this.phaseIncrement=0}extend(PhaseGenerator.prototype,{setFrequency:function(f_number,block,mult){var baseFrequency=f_number*Math.pow(2,block-1)*OPL3Data.sampleRate/Math.pow(2,19);var operatorFrequency=baseFrequency*OperatorData.multTable[mult];this.phaseIncrement=operatorFrequency/OPL3Data.sampleRate},getPhase:function(vib){if(vib==1){this.phase+=this.phaseIncrement*OPL3Data.vibratoTable[this.opl.dvb][this.opl.vibratoIndex]}else{this.phase+=this.phaseIncrement}this.phase%=1;return this.phase},keyOn:function(){this.phase=0}});function RhythmChannel(baseAddress,o1,o2,opl){Channel2op.call(this,baseAddress,o1,o2,opl)}util.inherits(RhythmChannel,Channel2op);RhythmChannel.prototype.getChannelOutput=function(){var channelOutput=0,op1Output=0,op2Output=0;op1Output=this.op1.getOperatorOutput(Operator.noModulator);op2Output=this.op2.getOperatorOutput(Operator.noModulator);channelOutput=(op1Output+op2Output)/2;return this.getInFourChannels(channelOutput)};RhythmChannel.prototype.keyOn=function(){};RhythmChannel.prototype.keyOff=function(){};function HighHatSnareDrumChannel(opl){RhythmChannel.call(this,7,opl.highHatOperator,opl.snareDrumOperator,opl)}util.inherits(HighHatSnareDrumChannel,RhythmChannel);function TomTomTopCymbalChannel(opl){RhythmChannel.call(this,8,opl.tomTomOperator,opl.topCymbalOperator,opl)}util.inherits(TomTomTopCymbalChannel,RhythmChannel);function TopCymbalOperator(baseAddress,opl){if(arguments.length==1){opl=baseAddress;baseAddress=21}Operator.call(this,baseAddress,opl)}util.inherits(TopCymbalOperator,Operator);TopCymbalOperator.prototype.getOperatorOutput=function(modulator,externalPhase){if(typeof externalPhase=="undefined")externalPhase=this.opl.highHatOperator.phase*OperatorData.multTable[this.opl.highHatOperator.mult];var envelopeInDB=this.envelopeGenerator.getEnvelope(this.egt,this.am);this.envelope=Math.pow(10,envelopeInDB/10);this.phase=this.phaseGenerator.getPhase(this.vib);var waveIndex=this.ws&(this.opl._new<<2)+3|0;var waveform=OperatorData.waveforms[waveIndex];var carrierPhase=8*this.phase%1;var modulatorPhase=externalPhase;var modulatorOutput=this.getOutput(Operator.noModulator,modulatorPhase,waveform);var carrierOutput=this.getOutput(modulatorOutput,carrierPhase,waveform);var cycles=4;if(carrierPhase*cycles%cycles>.1)carrierOutput=0;return carrierOutput*2};function HighHatOperator(opl){TopCymbalOperator.call(this,17,opl)}util.inherits(HighHatOperator,TopCymbalOperator);HighHatOperator.prototype.getOperatorOutput=function(modulator){var topCymbalOperatorPhase=this.opl.topCymbalOperator.phase*OperatorData.multTable[this.opl.topCymbalOperator.mult];var operatorOutput=TopCymbalOperator.prototype.getOperatorOutput.call(this,modulator,topCymbalOperatorPhase);if(operatorOutput==0)operatorOutput=Math.random()*this.envelope;return operatorOutput};function SnareDrumOperator(opl){Operator.call(this,20,opl)}util.inherits(SnareDrumOperator,Operator);SnareDrumOperator.prototype.getOperatorOutput=function(modulator){if(this.envelopeGenerator.stage==EnvelopeGenerator.Stage.OFF)return 0;var envelopeInDB=this.envelopeGenerator.getEnvelope(this.egt,this.am);this.envelope=Math.pow(10,envelopeInDB/10);var waveIndex=this.ws&(this.opl._new<<2)+3|0;var waveform=OperatorData.waveforms[waveIndex];this.phase=this.opl.highHatOperator.phase*2;var operatorOutput=this.getOutput(modulator,this.phase,waveform);var noise=Math.random()*this.envelope;if(operatorOutput/this.envelope!=1&&operatorOutput/this.envelope!=-1){if(operatorOutput>0)operatorOutput=noise;else if(operatorOutput<0)operatorOutput=-noise;else operatorOutput=0}return operatorOutput*2};function TomTomOperator(opl){Operator.call(this,18,opl)}util.inherits(TomTomOperator,Operator);function BassDrumChannel(opl){Channel2op.call(this,6,new Operator(16,opl),new Operator(19,opl),opl)}util.inherits(BassDrumChannel,Channel2op);BassDrumChannel.prototype.getChannelOutput=function(){if(this.cnt==1)this.op1.ar=0;return Channel2op.prototype.getChannelOutput.call(this)};BassDrumChannel.prototype.keyOn=function(){};BassDrumChannel.prototype.keyOff=function(){};var OPL3Data={_1_NTS1_6_Offset:8,DAM1_DVB1_RYT1_BD1_SD1_TOM1_TC1_HH1_Offset:189,_7_NEW1_Offset:261,_2_CONNECTIONSEL6_Offset:260,sampleRate:49700,vibratoTable:[new Float64Array(8192),new Float64Array(8192)],tremoloTable:[new Float64Array(13432),new Float64Array(13432)],loadVibratoTable:function(vibratoTable){var semitone=Math.pow(2,1/12);var cent=Math.pow(semitone,1/100);var DVB0=Math.pow(cent,7);var DVB1=Math.pow(cent,14);var i;for(i=0;i<1024;i++){vibratoTable[0][i]=vibratoTable[1][i]=1}for(;i<2048;i++){vibratoTable[0][i]=Math.sqrt(DVB0);vibratoTable[1][i]=Math.sqrt(DVB1)}for(;i<3072;i++){vibratoTable[0][i]=DVB0;vibratoTable[1][i]=DVB1}for(;i<4096;i++){vibratoTable[0][i]=Math.sqrt(DVB0);vibratoTable[1][i]=Math.sqrt(DVB1)}for(;i<5120;i++){vibratoTable[0][i]=vibratoTable[1][i]=1}for(;i<6144;i++){vibratoTable[0][i]=1/Math.sqrt(DVB0);vibratoTable[1][i]=1/Math.sqrt(DVB1)}for(;i<7168;i++){vibratoTable[0][i]=1/DVB0;vibratoTable[1][i]=1/DVB1}for(;i<8192;i++){vibratoTable[0][i]=1/Math.sqrt(DVB0);vibratoTable[1][i]=1/Math.sqrt(DVB1)}},loadTremoloTable:function(tremoloTable){var tremoloFrequency=3.7;var tremoloDepth=[-1,-4.8];var tremoloIncrement=[OPL3Data.calculateIncrement(tremoloDepth[0],0,1/(2*tremoloFrequency)),OPL3Data.calculateIncrement(tremoloDepth[1],0,1/(2*tremoloFrequency))];var tremoloTableLength=OPL3Data.sampleRate/tremoloFrequency|0;tremoloTable[0][0]=tremoloDepth[0];tremoloTable[1][0]=tremoloDepth[1];var counter=0;while(tremoloTable[0][counter]<0){counter++;tremoloTable[0][counter]=tremoloTable[0][counter-1]+tremoloIncrement[0];tremoloTable[1][counter]=tremoloTable[1][counter-1]+tremoloIncrement[1]}while(tremoloTable[0][counter]>tremoloDepth[0]&&counter<tremoloTableLength-1){counter++;tremoloTable[0][counter]=tremoloTable[0][counter-1]-tremoloIncrement[0];tremoloTable[1][counter]=tremoloTable[1][counter-1]-tremoloIncrement[1]}},calculateIncrement:function(begin,end,period){return(end-begin)/OPL3Data.sampleRate*(1/period)}};OPL3Data.loadVibratoTable(OPL3Data.vibratoTable);OPL3Data.loadTremoloTable(OPL3Data.tremoloTable);var ChannelData={_2_KON1_BLOCK3_FNUMH2_Offset:176,FNUML8_Offset:160,CHD1_CHC1_CHB1_CHA1_FB3_CNT1_Offset:192,feedback:[0,1/32,1/16,1/8,1/4,1/2,1,2]};var OperatorData={AM1_VIB1_EGT1_KSR1_MULT4_Offset:32,KSL2_TL6_Offset:64,AR4_DR4_Offset:96,SL4_RR4_Offset:128,_5_WS3_Offset:224,NO_MODULATION:"NO_MODULATION",CARRIER:"CARRIER",FEEDBACK:"FEEDBACK",waveLength:1024,multTable:[.5,1,2,3,4,5,6,7,8,9,10,10,12,12,15,15],ksl3dBtable:[[0,0,0,0,0,0,0,0],[0,0,0,0,0,-3,-6,-9],[0,0,0,0,-3,-6,-9,-12],[0,0,0,-1.875,-4.875,-7.875,-10.875,-13.875],[0,0,0,-3,-6,-9,-12,-15],[0,0,-1.125,-4.125,-7.125,-10.125,-13.125,-16.125],[0,0,-1.875,-4.875,-7.875,-10.875,-13.875,-16.875],[0,0,-2.625,-5.625,-8.625,-11.625,-14.625,-17.625],[0,0,-3,-6,-9,-12,-15,-18],[0,-.75,-3.75,-6.75,-9.75,-12.75,-15.75,-18.75],[0,-1.125,-4.125,-7.125,-10.125,-13.125,-16.125,-19.125],[0,-1.5,-4.5,-7.5,-10.5,-13.5,-16.5,-19.5],[0,-1.875,-4.875,-7.875,-10.875,-13.875,-16.875,-19.875],[0,-2.25,-5.25,-8.25,-11.25,-14.25,-17.25,-20.25],[0,-2.625,-5.625,-8.625,-11.625,-14.625,-17.625,-20.625],[0,-3,-6,-9,-12,-15,-18,-21]],waveforms:[new Float64Array(1024),new Float64Array(1024),new Float64Array(1024),new Float64Array(1024),new Float64Array(1024),new Float64Array(1024),new Float64Array(1024),new Float64Array(1024)],loadWaveforms:function(waveforms){for(var i=0,theta=0;i<1024;i++,theta+=2*Math.PI/1024){waveforms[0][i]=Math.sin(theta)}var sineTable=waveforms[0];for(var i=0;i<512;i++){waveforms[1][i]=sineTable[i];waveforms[1][512+i]=0}for(var i=0;i<512;i++){waveforms[2][i]=waveforms[2][512+i]=sineTable[i]}for(var i=0;i<256;i++){waveforms[3][i]=waveforms[3][512+i]=sineTable[i];waveforms[3][256+i]=waveforms[3][768+i]=0}for(var i=0;i<512;i++){waveforms[4][i]=sineTable[i*2];waveforms[4][512+i]=0}for(var i=0;i<256;i++){waveforms[5][i]=waveforms[5][256+i]=sineTable[i*2];waveforms[5][512+i]=waveforms[5][768+i]=0}for(var i=0;i<512;i++){waveforms[6][i]=1;waveforms[6][512+i]=-1}for(var i=0,x=0;i<512;i++,x+=16/256){waveforms[7][i]=Math.pow(2,-x);waveforms[7][1023-i]=-Math.pow(2,-(x+1/16))}}};OperatorData.loadWaveforms(OperatorData.waveforms);var EnvelopeGeneratorData={rateOffset:[[0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],attackTimeValuesTable:[[Infinity,Infinity],[Infinity,Infinity],[Infinity,Infinity],[Infinity,Infinity],[2826.24,1482.75],[2252.8,1155.07],[1884.16,991.23],[1597.44,868.35],[1413.12,741.38],[1126.4,577.54],[942.08,495.62],[798.72,434.18],[706.56,370.69],[563.2,288.77],[471.04,247.81],[399.36,217.09],[353.28,185.34],[281.6,144.38],[235.52,123.9],[199.68,108.54],[176.76,92.67],[140.8,72.19],[117.76,61.95],[99.84,54.27],[88.32,46.34],[70.4,36.1],[58.88,30.98],[49.92,27.14],[44.16,23.17],[35.2,18.05],[29.44,15.49],[24.96,13.57],[22.08,11.58],[17.6,9.02],[14.72,7.74],[12.48,6.78],[11.04,5.79],[8.8,4.51],[7.36,3.87],[6.24,3.39],[5.52,2.9],[4.4,2.26],[3.68,1.94],[3.12,1.7],[2.76,1.45],[2.2,1.13],[1.84,.97],[1.56,.85],[1.4,.73],[1.12,.61],[.92,.49],[.8,.43],[.7,.37],[.56,.31],[.46,.26],[.42,.22],[.38,.19],[.3,.14],[.24,.11],[.2,.11],[0,0],[0,0],[0,0],[0,0]],decayAndReleaseTimeValuesTable:[[Infinity,Infinity],[Infinity,Infinity],[Infinity,Infinity],[Infinity,Infinity],[39280.64,8212.48],[31416.32,6574.08],[26173.44,5509.12],[22446.08,4730.88],[19640.32,4106.24],[15708.16,3287.04],[13086.72,2754.56],[11223.04,2365.44],[9820.16,2053.12],[7854.08,1643.52],[6543.36,1377.28],[5611.52,1182.72],[4910.08,1026.56],[3927.04,821.76],[3271.68,688.64],[2805.76,591.36],[2455.04,513.28],[1936.52,410.88],[1635.84,344.34],[1402.88,295.68],[1227.52,256.64],[981.76,205.44],[817.92,172.16],[701.44,147.84],[613.76,128.32],[490.88,102.72],[488.96,86.08],[350.72,73.92],[306.88,64.16],[245.44,51.36],[204.48,43.04],[175.36,36.96],[153.44,32.08],[122.72,25.68],[102.24,21.52],[87.68,18.48],[76.72,16.04],[61.36,12.84],[51.12,10.76],[43.84,9.24],[38.36,8.02],[30.68,6.42],[25.56,5.38],[21.92,4.62],[19.2,4.02],[15.36,3.22],[12.8,2.68],[10.96,2.32],[9.6,2.02],[7.68,1.62],[6.4,1.35],[5.48,1.15],[4.8,1.01],[3.84,.81],[3.2,.69],[2.74,.58],[2.4,.51],[2.4,.51],[2.4,.51],[2.4,.51]]}},{extend:21,util:47}],11:[function(_dereq_,module,exports){(function(process,Buffer){var Readable=_dereq_("stream").Readable;var util=_dereq_("util");var WritableStreamBuffer=_dereq_("stream-buffers").WritableStreamBuffer;_dereq_("setimmediate");var OPL3=_dereq_("./opl3");var Normalizer=_dereq_("./normalizer");var ConvertTo32Bit=_dereq_("./convertto32bit");var currentScriptSrc=null;try{currentScriptSrc=document.currentScript.src}catch(err){}function Player(format,options){Readable.call(this);options=options||{};var self=this;var initNormalizer=function(){if(options.normalization){self.normalizer=new Normalizer(options.bitDepth||16);self.pipe(self.normalizer);self.normalizer.on("normalization",function(value){self.emit("normalization",value)});self.normalizer.on("gain",function(value){self.emit("gain",value)});self.normalizer.on("error",function(err){self.emit("error",err)})}};var initPostMessage=function(postMessage){if(typeof postMessage=="function"){self.on("end",function(){postMessage({cmd:"end"})});self.on("progress",function(value){postMessage({cmd:"progress",value:value})});self.on("error",function(err){throw err});self.on("midi",function(midi){postMessage({cmd:"midi",value:midi},[midi])});if(options.normalization){self.normalizer.on("normalization",function(value){postMessage({cmd:"normalization",value:value})});self.normalizer.on("gain",function(value){postMessage({cmd:"gain",value:value})});self.normalizer.on("data",function(chunk){postMessage({cmd:"data",value:chunk.buffer},[chunk.buffer])})}else{self.on("data",function(chunk){postMessage({cmd:"data",value:chunk.buffer},[chunk.buffer])})}}};var load=function(buffer,callback,postMessage){return new Promise(function(resolve,reject){try{var bufferWriter=new WritableStreamBuffer({initialSize:1024*1024,incrementAmount:512*1024});var onEnd=function(){var pcmBuffer=bufferWriter.getContents().buffer;if(typeof callback=="function")callback(null,pcmBuffer);resolve(pcmBuffer);options.prebuffer=-1};if(options.normalization){self.normalizer.pipe(bufferWriter);self.normalizer.on("end",onEnd)}else{self.pipe(bufferWriter);self.on("end",onEnd)}self.on("error",reject);if(buffer instanceof ArrayBuffer)buffer=new Buffer(buffer);initPostMessage(postMessage);var player=new format(new OPL3,options);player.load(buffer);var aborted=false;self.abort=function(){self.emit("abort");aborted=true};var len=0;var dlen=0;var samplesBuffer=null;var bufferType=options.bitDepth==32?Float32Array:Int16Array;if(options.bufferSize){samplesBuffer=new bufferType(options.bufferSize*2)}var sampleRate=49700*((options.sampleRate||49700)/49700);var fn=function(){if(aborted)return;var start=Date.now();while(player.update()){if(aborted)return;var d=player.refresh();var n=4*(sampleRate*d|0);len+=n;dlen+=d;self.emit("progress",Math.floor(player.position/player.data.byteLength*1e3)/10);var chunkSize=n/2|0;if(options.bufferSize){while(chunkSize>0){samplesSize=Math.min(options.bufferSize*2,chunkSize);chunkSize-=samplesSize;player.opl.read(samplesBuffer);self.emit("data",new Buffer(samplesBuffer.buffer));samplesBuffer=new bufferType(options.bufferSize*2)}}else{var buffer=new bufferType(chunkSize);player.opl.read(buffer);self.emit("data",new Buffer(buffer.buffer))}if(Date.now()-start>1e3)return setImmediate(fn)}self.emit("progress",100);if(player.midiBuffer)self.emit("midi",new Buffer(player.midiBuffer,"binary").buffer);self.emit("end")};fn()}catch(err){self.emit("error",err);if(typeof callback=="function")callback(err,null);reject(err)}})};options.prebuffer=options.prebuffer||200;if(typeof AudioContext!="undefined"){var context=new AudioContext;var source=context.createBufferSource();var processor=context.createScriptProcessor(2048,0,2);var gain=context.createGain();gain.gain.value=options.volume||1;var queue=[];var bufferLeft,bufferRight,silence,queuePos,bufferPerMs;var audioQueueFn=function(e){var outputBuffer=e.outputBuffer;if(self.length>=options.prebuffer){for(var i=0;i<processor.bufferSize/options.bufferSize;i++){var tmp=queue[queuePos];if(tmp){queuePos++;self.emit("position",self.position);var dv=new DataView(tmp.buffer||tmp);for(var j=0,offset=0;j<options.bufferSize;j++,offset+=8){bufferLeft[j]=dv.getFloat32(offset,true);bufferRight[j]=dv.getFloat32(offset+4,true)}}else{bufferLeft.set(silence);bufferRight.set(silence)}outputBuffer.copyToChannel(bufferLeft,0,i*options.bufferSize);outputBuffer.copyToChannel(bufferRight,1,i*options.bufferSize)}}};var backupQueue=null;var isPlayInit=false;this.play=function(buffer){if(!isPlayInit){options.bufferSize=options.bufferSize||64;options.sampleRate=context.sampleRate;options.bitDepth=32;bufferLeft=new Float32Array(options.bufferSize);bufferRight=new Float32Array(options.bufferSize);silence=new Float32Array(options.bufferSize);queuePos=0;bufferPerMs=options.sampleRate/1e3/options.bufferSize;self.load(buffer);self.on("data",function(buffer){if(backupQueue)backupQueue.push(buffer);else queue.push(buffer)});processor.onaudioprocess=audioQueueFn;source.connect(processor);processor.connect(gain);gain.connect(context.destination);source.start();isPlayInit=true}if(backupQueue){queue=backupQueue;backupQueue=null}};this.pause=function(){backupQueue=queue;queue=[]};this.on("abort",this.pause);this.seek=function(ms){queuePos=Math.floor(ms*bufferPerMs)};Object.defineProperty(this,"position",{get:function(){return Math.floor(queuePos/bufferPerMs)}});Object.defineProperty(this,"length",{get:function(){return Math.floor((backupQueue||queue).length/bufferPerMs)}});Object.defineProperty(this,"volume",{get:function(){return gain.gain.value},set:function(value){gain.gain.value=value}})}if(!options.disableWorker&&process.browser&&typeof window!="undefined"&&"Worker"in window){try{var self=this;this.load=function(buffer,callback,postMessage){initPostMessage(postMessage);var formatName=format.name;var workerSrc=['importScripts("'+currentScriptSrc+'");',"onmessage = function(msg){","   var player = new OPL3.Player(OPL3.format."+formatName+", msg.data.options);","   player.load(msg.data.buffer, function(err, buffer){","       if (err) throw err;",'       postMessage({ cmd: "callback", value: buffer }, [buffer]);',"   }, postMessage);","};"].join("\n");var blob;try{blob=new Blob([workerSrc],{type:"application/javascript"})}catch(e){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;blob=new BlobBuilder;blob.append(workerSrc);blob=blob.getBlob()}var worker=new Worker(URL.createObjectURL(blob));worker.onmessage=function(msg){self.emit(msg.data.cmd,msg.data.value);if(msg.data.cmd=="callback"){if(typeof callback=="function")callback(null,msg.data.value);worker.terminate()}};worker.onerror=function(err){self.emit("error",err);if(typeof callback=="function")callback(err,null)};self.abort=function(){worker.terminate();self.emit("abort")};worker.postMessage({buffer:buffer,options:options},[buffer])}}catch(err){console.warn("OPL3 WebWorker not supported! :(");options.prebuffer=Infinity;initNormalizer();this.load=load}}else{options.prebuffer=Infinity;initNormalizer();this.load=load}this._read=function(){}}util.inherits(Player,Readable);module.exports=Player}).call(this,_dereq_("_process"),_dereq_("buffer").Buffer)},{"./convertto32bit":8,"./normalizer":9,"./opl3":10,_process:26,buffer:16,setimmediate:27,stream:28,"stream-buffers":42,util:47}],12:[function(_dereq_,module,exports){function WAV(data,sampleRate,bitDepth){bitDepth=bitDepth||16;if(data instanceof ArrayBuffer)data=new Uint8Array(data);var buffer=new Uint8Array(data.byteLength+44);var blockAlign=2*bitDepth>>3;var byteRate=blockAlign*sampleRate;var subChunk2Size=data.length*(bitDepth>>3)/2;var chunkSize=36+subChunk2Size;buffer[0]=82;buffer[1]=73;buffer[2]=70;buffer[3]=70;buffer[4]=chunkSize&255;buffer[5]=chunkSize>>8&255;buffer[6]=chunkSize>>16&255;buffer[7]=chunkSize>>24&255;buffer[8]=87;buffer[9]=65;buffer[10]=86;buffer[11]=69;buffer[12]=102;buffer[13]=109;buffer[14]=116;buffer[15]=32;buffer[16]=16;buffer[17]=0;buffer[18]=0;buffer[19]=0;buffer[20]=bitDepth==32?3:1;buffer[21]=0;buffer[22]=2;buffer[23]=0;buffer[24]=sampleRate&255;buffer[25]=sampleRate>>8&255;buffer[26]=sampleRate>>16&255;buffer[27]=sampleRate>>24&255;buffer[28]=byteRate&255;buffer[29]=byteRate>>8&255;buffer[30]=byteRate>>16&255;buffer[31]=byteRate>>24&255;buffer[32]=blockAlign&255;buffer[33]=blockAlign>>8&255;buffer[34]=bitDepth;buffer[35]=0;buffer[36]=100;buffer[37]=97;buffer[38]=116;buffer[39]=97;buffer[40]=subChunk2Size&255;buffer[41]=subChunk2Size>>8&255;buffer[42]=subChunk2Size>>16&255;buffer[43]=subChunk2Size>>24&255;buffer.set(data,44);return buffer}module.exports=WAV},{}],13:[function(_dereq_,module,exports){"use strict";exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;function init(){var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63}init();function toByteArray(b64){var i,j,l,tmp,placeHolders,arr;var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}placeHolders=b64[len-2]==="="?2:b64[len-1]==="="?1:0;arr=new Arr(len*3/4-placeHolders);l=placeHolders>0?len-4:len;var L=0;for(i=0,j=0;i<l;i+=4,j+=3){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[L++]=tmp>>16&255;arr[L++]=tmp>>8&255;arr[L++]=tmp&255}if(placeHolders===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[L++]=tmp&255}else if(placeHolders===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[L++]=tmp>>8&255;arr[L++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){
var tmp;var len=uint8.length;var extraBytes=len%3;var output="";var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];output+=lookup[tmp>>2];output+=lookup[tmp<<4&63];output+="=="}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];output+=lookup[tmp>>10];output+=lookup[tmp>>4&63];output+=lookup[tmp<<2&63];output+="="}parts.push(output);return parts.join("")}},{}],14:[function(_dereq_,module,exports){},{}],15:[function(_dereq_,module,exports){(function(global){"use strict";var buffer=_dereq_("buffer");var Buffer=buffer.Buffer;var SlowBuffer=buffer.SlowBuffer;var MAX_LEN=buffer.kMaxLength||2147483647;exports.alloc=function alloc(size,fill,encoding){if(typeof Buffer.alloc==="function"){return Buffer.alloc(size,fill,encoding)}if(typeof encoding==="number"){throw new TypeError("encoding must not be number")}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>MAX_LEN){throw new RangeError("size is too large")}var enc=encoding;var _fill=fill;if(_fill===undefined){enc=undefined;_fill=0}var buf=new Buffer(size);if(typeof _fill==="string"){var fillBuf=new Buffer(_fill,enc);var flen=fillBuf.length;var i=-1;while(++i<size){buf[i]=fillBuf[i%flen]}}else{buf.fill(_fill)}return buf};exports.allocUnsafe=function allocUnsafe(size){if(typeof Buffer.allocUnsafe==="function"){return Buffer.allocUnsafe(size)}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>MAX_LEN){throw new RangeError("size is too large")}return new Buffer(size)};exports.from=function from(value,encodingOrOffset,length){if(typeof Buffer.from==="function"&&(!global.Uint8Array||Uint8Array.from!==Buffer.from)){return Buffer.from(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof value==="string"){return new Buffer(value,encodingOrOffset)}if(typeof ArrayBuffer!=="undefined"&&value instanceof ArrayBuffer){var offset=encodingOrOffset;if(arguments.length===1){return new Buffer(value)}if(typeof offset==="undefined"){offset=0}var len=length;if(typeof len==="undefined"){len=value.byteLength-offset}if(offset>=value.byteLength){throw new RangeError("'offset' is out of bounds")}if(len>value.byteLength-offset){throw new RangeError("'length' is out of bounds")}return new Buffer(value.slice(offset,offset+len))}if(Buffer.isBuffer(value)){var out=new Buffer(value.length);value.copy(out,0,0,value.length);return out}if(value){if(Array.isArray(value)||typeof ArrayBuffer!=="undefined"&&value.buffer instanceof ArrayBuffer||"length"in value){return new Buffer(value)}if(value.type==="Buffer"&&Array.isArray(value.data)){return new Buffer(value.data)}}throw new TypeError("First argument must be a string, Buffer, "+"ArrayBuffer, Array, or array-like object.")};exports.allocUnsafeSlow=function allocUnsafeSlow(size){if(typeof Buffer.allocUnsafeSlow==="function"){return Buffer.allocUnsafeSlow(size)}if(typeof size!=="number"){throw new TypeError("size must be a number")}if(size>=MAX_LEN){throw new RangeError("size is too large")}return new SlowBuffer(size)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{buffer:16}],16:[function(_dereq_,module,exports){(function(global){"use strict";var base64=_dereq_("base64-js");var ieee754=_dereq_("ieee754");var isArray=_dereq_("isarray");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=global.TYPED_ARRAY_SUPPORT!==undefined?global.TYPED_ARRAY_SUPPORT:typedArraySupport();exports.kMaxLength=kMaxLength();function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42&&typeof arr.subarray==="function"&&arr.subarray(1,1).byteLength===0}catch(e){return false}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length){throw new RangeError("Invalid typed array length")}if(Buffer.TYPED_ARRAY_SUPPORT){that=new Uint8Array(length);that.__proto__=Buffer.prototype}else{if(that===null){that=new Buffer(length)}that.length=length}return that}function Buffer(arg,encodingOrOffset,length){if(!Buffer.TYPED_ARRAY_SUPPORT&&!(this instanceof Buffer)){return new Buffer(arg,encodingOrOffset,length)}if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}Buffer.poolSize=8192;Buffer._augment=function(arr){arr.__proto__=Buffer.prototype;return arr};function from(that,value,encodingOrOffset,length){if(typeof value==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&value instanceof ArrayBuffer){return fromArrayBuffer(that,value,encodingOrOffset,length)}if(typeof value==="string"){return fromString(that,value,encodingOrOffset)}return fromObject(that,value)}Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)};if(Buffer.TYPED_ARRAY_SUPPORT){Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;if(typeof Symbol!=="undefined"&&Symbol.species&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true})}}function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be a number')}}function alloc(that,size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(that,size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill)}return createBuffer(that,size)}Buffer.alloc=function(size,fill,encoding){return alloc(null,size,fill,encoding)};function allocUnsafe(that,size){assertSize(size);that=createBuffer(that,size<0?0:checked(size)|0);if(!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<size;++i){that[i]=0}}return that}Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)};function fromString(that,string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError('"encoding" must be a valid string encoding')}var length=byteLength(string,encoding)|0;that=createBuffer(that,length);that.write(string,encoding);return that}function fromArrayLike(that,array){var length=checked(array.length)|0;that=createBuffer(that,length);for(var i=0;i<length;i+=1){that[i]=array[i]&255}return that}function fromArrayBuffer(that,array,byteOffset,length){array.byteLength;if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError("'offset' is out of bounds")}if(array.byteLength<byteOffset+(length||0)){throw new RangeError("'length' is out of bounds")}if(length===undefined){array=new Uint8Array(array,byteOffset)}else{array=new Uint8Array(array,byteOffset,length)}if(Buffer.TYPED_ARRAY_SUPPORT){that=array;that.__proto__=Buffer.prototype}else{that=fromArrayLike(that,array)}return that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;that=createBuffer(that,len);if(that.length===0){return that}obj.copy(that,0,0,len);return that}if(obj){if(typeof ArrayBuffer!=="undefined"&&obj.buffer instanceof ArrayBuffer||"length"in obj){if(typeof obj.length!=="number"||isnan(obj.length)){return createBuffer(that,0)}return fromArrayLike(that,obj)}if(obj.type==="Buffer"&&isArray(obj.data)){return fromArrayLike(that,obj.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=kMaxLength()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+kMaxLength().toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return!!(b!=null&&b._isBuffer)};Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError("Arguments must be Buffers")}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){string=""+string}var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":case undefined:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.toString=function toString(){var length=this.length|0;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;if(this.length>0){str=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str+=" ... "}return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target)){throw new TypeError("Argument must be a Buffer")}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function arrayIndexOf(arr,val,byteOffset,encoding){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var foundIndex=-1;for(var i=byteOffset;i<arrLength;++i){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}return-1}Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset>>=0;if(this.length===0)return-1;if(byteOffset>=this.length)return-1;if(byteOffset<0)byteOffset=Math.max(this.length+byteOffset,0);if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(this,val,byteOffset,encoding)}if(typeof val==="number"){if(Buffer.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function"){return Uint8Array.prototype.indexOf.call(this,val,byteOffset)}return arrayIndexOf(this,[val],byteOffset,encoding)}throw new TypeError("val must be string, number or Buffer")};Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset|0;if(isFinite(length)){length=length|0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT){newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype}else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,undefined);for(var i=0;i<sliceLen;++i){newBuf[i]=this[i+start]}}return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,255,0);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);this[offset]=value&255;return offset+1};function objectWriteUInt16(buf,value,offset,littleEndian){if(value<0)value=65535+value+1;for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i){buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}}Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8}else{objectWriteUInt16(this,value,offset,true)}return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value&255}else{objectWriteUInt16(this,value,offset,false)}return offset+2};function objectWriteUInt32(buf,value,offset,littleEndian){if(value<0)value=4294967295+value+1;for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i){buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}}Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255}else{objectWriteUInt32(this,value,offset,true)}return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255}else{objectWriteUInt32(this,value,offset,false)}return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8}else{objectWriteUInt16(this,value,offset,true)}return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value&255}else{objectWriteUInt16(this,value,offset,false)}return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24}else{objectWriteUInt32(this,value,offset,true)}return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255}else{objectWriteUInt32(this,value,offset,false)}return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert){checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;var i;if(this===target&&start<targetStart&&targetStart<end){for(i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT){for(i=0;i<len;++i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(val.length===1){var code=val.charCodeAt(0);if(code<256){val=code}}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{
var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString());var len=bytes.length;for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(str){str=stringtrim(str).replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isnan(val){return val!==val}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"base64-js":13,ieee754:22,isarray:17}],17:[function(_dereq_,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"}},{}],18:[function(_dereq_,module,exports){(function(Buffer){function isArray(arg){if(Array.isArray){return Array.isArray(arg)}return objectToString(arg)==="[object Array]"}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return objectToString(e)==="[object Error]"||e instanceof Error}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=Buffer.isBuffer;function objectToString(o){return Object.prototype.toString.call(o)}}).call(this,{isBuffer:_dereq_("../../is-buffer/index.js")})},{"../../is-buffer/index.js":24}],19:[function(_dereq_,module,exports){DataView.prototype.getString=function(offset,length){var end=typeof length=="number"?offset+length:this.byteLength;var text="";var val=-1;while(offset<this.byteLength&&offset<end){val=this.getUint8(offset++);if(val==0)break;text+=String.fromCharCode(val)}return text}},{}],20:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Uncaught, unspecified "error" event. ('+er+")");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-- >0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],21:[function(_dereq_,module,exports){"use strict";var hasOwn=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var isArray=function isArray(arr){if(typeof Array.isArray==="function"){return Array.isArray(arr)}return toStr.call(arr)==="[object Array]"};var isPlainObject=function isPlainObject(obj){if(!obj||toStr.call(obj)!=="[object Object]"){return false}var hasOwnConstructor=hasOwn.call(obj,"constructor");var hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return false}var key;for(key in obj){}return typeof key==="undefined"||hasOwn.call(obj,key)};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}else if(typeof target!=="object"&&typeof target!=="function"||target==null){target={}}for(;i<length;++i){options=arguments[i];if(options!=null){for(name in options){src=target[name];copy=options[name];if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}target[name]=extend(deep,clone,copy)}else if(typeof copy!=="undefined"){target[name]=copy}}}}}return target}},{}],22:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],23:[function(_dereq_,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],24:[function(_dereq_,module,exports){module.exports=function(obj){return!!(obj!=null&&(obj._isBuffer||obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj)))}},{}],25:[function(_dereq_,module,exports){(function(process){"use strict";if(!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0){module.exports=nextTick}else{module.exports=process.nextTick}function nextTick(fn,arg1,arg2,arg3){if(typeof fn!=="function"){throw new TypeError('"callback" argument must be a function')}var len=arguments.length;var args,i;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function afterTickOne(){fn.call(null,arg1)});case 3:return process.nextTick(function afterTickTwo(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function afterTickThree(){fn.call(null,arg1,arg2,arg3)});default:args=new Array(len-1);i=0;while(i<args.length){args[i++]=arguments[i]}return process.nextTick(function afterTick(){fn.apply(null,args)})}}}).call(this,_dereq_("_process"))},{_process:26}],26:[function(_dereq_,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;(function(){try{cachedSetTimeout=setTimeout}catch(e){cachedSetTimeout=function(){throw new Error("setTimeout is not defined")}}try{cachedClearTimeout=clearTimeout}catch(e){cachedClearTimeout=function(){throw new Error("clearTimeout is not defined")}}})();var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=cachedSetTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;cachedClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){cachedSetTimeout(drainQueue,0)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],27:[function(_dereq_,module,exports){(function(process,global){(function(global,undefined){"use strict";if(global.setImmediate){return}var nextHandle=1;var tasksByHandle={};var currentlyRunningATask=false;var doc=global.document;var setImmediate;function addFromSetImmediateArguments(args){tasksByHandle[nextHandle]=partiallyApplied.apply(undefined,args);return nextHandle++}function partiallyApplied(handler){var args=[].slice.call(arguments,1);return function(){if(typeof handler==="function"){handler.apply(undefined,args)}else{new Function(""+handler)()}}}function runIfPresent(handle){if(currentlyRunningATask){setTimeout(partiallyApplied(runIfPresent,handle),0)}else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=true;try{task()}finally{clearImmediate(handle);currentlyRunningATask=false}}}}function clearImmediate(handle){delete tasksByHandle[handle]}function installNextTickImplementation(){setImmediate=function(){var handle=addFromSetImmediateArguments(arguments);process.nextTick(partiallyApplied(runIfPresent,handle));return handle}}function canUsePostMessage(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=true;var oldOnMessage=global.onmessage;global.onmessage=function(){postMessageIsAsynchronous=false};global.postMessage("","*");global.onmessage=oldOnMessage;return postMessageIsAsynchronous}}function installPostMessageImplementation(){var messagePrefix="setImmediate$"+Math.random()+"$";var onGlobalMessage=function(event){if(event.source===global&&typeof event.data==="string"&&event.data.indexOf(messagePrefix)===0){runIfPresent(+event.data.slice(messagePrefix.length))}};if(global.addEventListener){global.addEventListener("message",onGlobalMessage,false)}else{global.attachEvent("onmessage",onGlobalMessage)}setImmediate=function(){var handle=addFromSetImmediateArguments(arguments);global.postMessage(messagePrefix+handle,"*");return handle}}function installMessageChannelImplementation(){var channel=new MessageChannel;channel.port1.onmessage=function(event){var handle=event.data;runIfPresent(handle)};setImmediate=function(){var handle=addFromSetImmediateArguments(arguments);channel.port2.postMessage(handle);return handle}}function installReadyStateChangeImplementation(){var html=doc.documentElement;setImmediate=function(){var handle=addFromSetImmediateArguments(arguments);var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle);script.onreadystatechange=null;html.removeChild(script);script=null};html.appendChild(script);return handle}}function installSetTimeoutImplementation(){setImmediate=function(){var handle=addFromSetImmediateArguments(arguments);setTimeout(partiallyApplied(runIfPresent,handle),0);return handle}}var attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global;if({}.toString.call(global.process)==="[object process]"){installNextTickImplementation()}else if(canUsePostMessage()){installPostMessageImplementation()}else if(global.MessageChannel){installMessageChannelImplementation()}else if(doc&&"onreadystatechange"in doc.createElement("script")){installReadyStateChangeImplementation()}else{installSetTimeoutImplementation()}attachTo.setImmediate=setImmediate;attachTo.clearImmediate=clearImmediate})(typeof self==="undefined"?typeof global==="undefined"?this:global:self)}).call(this,_dereq_("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:26}],28:[function(_dereq_,module,exports){module.exports=Stream;var EE=_dereq_("events").EventEmitter;var inherits=_dereq_("inherits");inherits(Stream,EE);Stream.Readable=_dereq_("readable-stream/readable.js");Stream.Writable=_dereq_("readable-stream/writable.js");Stream.Duplex=_dereq_("readable-stream/duplex.js");Stream.Transform=_dereq_("readable-stream/transform.js");Stream.PassThrough=_dereq_("readable-stream/passthrough.js");Stream.Stream=Stream;function Stream(){EE.call(this)}Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable){if(false===dest.write(chunk)&&source.pause){source.pause()}}}source.on("data",ondata);function ondrain(){if(source.readable&&source.resume){source.resume()}}dest.on("drain",ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on("end",onend);source.on("close",onclose)}var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end()}function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==="function")dest.destroy()}function onerror(er){cleanup();if(EE.listenerCount(this,"error")===0){throw er}}source.on("error",onerror);dest.on("error",onerror);function cleanup(){source.removeListener("data",ondata);dest.removeListener("drain",ondrain);source.removeListener("end",onend);source.removeListener("close",onclose);source.removeListener("error",onerror);dest.removeListener("error",onerror);source.removeListener("end",cleanup);source.removeListener("close",cleanup);dest.removeListener("close",cleanup)}source.on("end",cleanup);source.on("close",cleanup);dest.on("close",cleanup);dest.emit("pipe",source);return dest}},{events:20,inherits:23,"readable-stream/duplex.js":30,"readable-stream/passthrough.js":36,"readable-stream/readable.js":37,"readable-stream/transform.js":38,"readable-stream/writable.js":39}],29:[function(_dereq_,module,exports){arguments[4][17][0].apply(exports,arguments)},{dup:17}],30:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":31}],31:[function(_dereq_,module,exports){"use strict";var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){keys.push(key)}return keys};module.exports=Duplex;var processNextTick=_dereq_("process-nextick-args");var util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");var Readable=_dereq_("./_stream_readable");var Writable=_dereq_("./_stream_writable");util.inherits(Duplex,Readable);var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method]}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);if(options&&options.readable===false)this.readable=false;if(options&&options.writable===false)this.writable=false;this.allowHalfOpen=true;if(options&&options.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",onend)}function onend(){if(this.allowHalfOpen||this._writableState.ended)return;processNextTick(onEndNT,this)}function onEndNT(self){self.end()}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i)}}},{"./_stream_readable":33,"./_stream_writable":35,"core-util-is":18,inherits:23,"process-nextick-args":25}],32:[function(_dereq_,module,exports){"use strict";module.exports=PassThrough;var Transform=_dereq_("./_stream_transform");var util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");util.inherits(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":34,"core-util-is":18,inherits:23}],33:[function(_dereq_,module,exports){(function(process){"use strict";module.exports=Readable;var processNextTick=_dereq_("process-nextick-args");var isArray=_dereq_("isarray");Readable.ReadableState=ReadableState;var EE=_dereq_("events").EventEmitter;var EElistenerCount=function(emitter,type){return emitter.listeners(type).length};var Stream;(function(){try{Stream=_dereq_("st"+"ream")}catch(_){}finally{if(!Stream)Stream=_dereq_("events").EventEmitter}})();var Buffer=_dereq_("buffer").Buffer;var bufferShim=_dereq_("buffer-shims");var util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");var debugUtil=_dereq_("util");var debug=void 0;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog("stream")}else{debug=function(){}}var StringDecoder;util.inherits(Readable,Stream);var hasPrependListener=typeof EE.prototype.prependListener==="function";function prependListener(emitter,event,fn){if(hasPrependListener)return emitter.prependListener(event,fn);if(!emitter._events||!emitter._events[event])emitter.on(event,fn);else if(isArray(emitter._events[event]))emitter._events[event].unshift(fn);else emitter._events[event]=[fn,emitter._events[event]]}var Duplex;function ReadableState(options,stream){Duplex=Duplex||_dereq_("./_stream_duplex");options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.readableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.buffer=[];this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=_dereq_("string_decoder/").StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding}}var Duplex;function Readable(options){Duplex=Duplex||_dereq_("./_stream_duplex");if(!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this);this.readable=true;if(options&&typeof options.read==="function")this._read=options.read;Stream.call(this)}Readable.prototype.push=function(chunk,encoding){var state=this._readableState;if(!state.objectMode&&typeof chunk==="string"){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=bufferShim.from(chunk,encoding);encoding=""}}return readableAddChunk(this,state,chunk,encoding,false)};Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",true)};Readable.prototype.isPaused=function(){return this._readableState.flowing===false};function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er){stream.emit("error",er)}else if(chunk===null){state.reading=false;onEofChunk(stream,state)}else if(state.objectMode||chunk&&chunk.length>0){if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var _e=new Error("stream.unshift() after end event");stream.emit("error",_e)}else{var skipAdd;if(state.decoder&&!addToFront&&!encoding){chunk=state.decoder.write(chunk);skipAdd=!state.objectMode&&chunk.length===0}if(!addToFront)state.reading=false;if(!skipAdd){if(state.flowing&&state.length===0&&!state.sync){stream.emit("data",chunk);stream.read(0)}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)state.buffer.unshift(chunk);else state.buffer.push(chunk);if(state.needReadable)emitReadable(stream)}}maybeReadMore(stream,state)}}else if(!addToFront){state.reading=false}return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||state.length===0)}Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=_dereq_("string_decoder/").StringDecoder;this._readableState.decoder=new StringDecoder(enc);this._readableState.encoding=enc;return this};var MAX_HWM=8388608;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++}return n}function howMuchToRead(n,state){if(state.length===0&&state.ended)return 0;if(state.objectMode)return n===0?0:1;if(n===null||isNaN(n)){if(state.flowing&&state.buffer.length)return state.buffer[0].length;else return state.length}if(n<=0)return 0;if(n>state.highWaterMark)state.highWaterMark=computeNewHighWaterMark(n);if(n>state.length){if(!state.ended){state.needReadable=true;return 0}else{return state.length}}return n}Readable.prototype.read=function(n){debug("read",n);var state=this._readableState;var nOrig=n;if(typeof n!=="number"||n>0)state.emittedReadable=false;if(n===0&&state.needReadable&&(state.length>=state.highWaterMark||state.ended)){debug("read: emitReadable",state.length,state.ended);if(state.length===0&&state.ended)endReadable(this);else emitReadable(this);return null}n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)endReadable(this);return null}var doRead=state.needReadable;debug("need readable",doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug("length less than watermark",doRead)}if(state.ended||state.reading){doRead=false;debug("reading or ended",doRead)}if(doRead){debug("do read");state.reading=true;state.sync=true;if(state.length===0)state.needReadable=true;this._read(state.highWaterMark);state.sync=false}if(doRead&&!state.reading)n=howMuchToRead(nOrig,state);var ret;if(n>0)ret=fromList(n,state);else ret=null;if(ret===null){state.needReadable=true;n=0}state.length-=n;if(state.length===0&&!state.ended)state.needReadable=true;if(nOrig!==n&&state.ended&&state.length===0)endReadable(this);if(ret!==null)this.emit("data",ret);return ret};function chunkInvalid(state,chunk){var er=null;if(!Buffer.isBuffer(chunk)&&typeof chunk!=="string"&&chunk!==null&&chunk!==undefined&&!state.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}return er}function onEofChunk(stream,state){if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length}}state.ended=true;emitReadable(stream)}function emitReadable(stream){var state=stream._readableState;state.needReadable=false;if(!state.emittedReadable){debug("emitReadable",state.flowing);state.emittedReadable=true;if(state.sync)processNextTick(emitReadable_,stream);else emitReadable_(stream)}}function emitReadable_(stream){debug("emit readable");stream.emit("readable");flow(stream)}function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;processNextTick(maybeReadMore_,stream,state)}}function maybeReadMore_(stream,state){var len=state.length;while(!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark){debug("maybeReadMore read 0");stream.read(0);if(len===state.length)break;else len=state.length}state.readingMore=false}Readable.prototype._read=function(n){this.emit("error",new Error("not implemented"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break}state.pipesCount+=1;debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:cleanup;if(state.endEmitted)processNextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable){debug("onunpipe");if(readable===src){cleanup()}}function onend(){debug("onend");dest.end()}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=false;function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",cleanup);src.removeListener("data",ondata);cleanedUp=true;if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain()}src.on("data",ondata);function ondata(chunk){debug("ondata");var ret=dest.write(chunk);if(false===ret){if((state.pipesCount===1&&state.pipes===dest||state.pipesCount>1&&indexOf(state.pipes,dest)!==-1)&&!cleanedUp){debug("false write response, pause",src._readableState.awaitDrain);src._readableState.awaitDrain++}src.pause()}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EElistenerCount(dest,"error")===0)dest.emit("error",er)}prependListener(dest,"error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe();
}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest)}dest.emit("pipe",src);if(!state.flowing){debug("pipe resume");src.resume()}return dest};function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain);if(state.awaitDrain)state.awaitDrain--;if(state.awaitDrain===0&&EElistenerCount(src,"data")){state.flowing=true;flow(src)}}}Readable.prototype.unpipe=function(dest){var state=this._readableState;if(state.pipesCount===0)return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)return this;if(!dest)dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)dest.emit("unpipe",this);return this}if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var _i=0;_i<len;_i++){dests[_i].emit("unpipe",this)}return this}var i=indexOf(state.pipes,dest);if(i===-1)return this;state.pipes.splice(i,1);state.pipesCount-=1;if(state.pipesCount===1)state.pipes=state.pipes[0];dest.emit("unpipe",this);return this};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if(ev==="data"&&false!==this._readableState.flowing){this.resume()}if(ev==="readable"&&!this._readableState.endEmitted){var state=this._readableState;if(!state.readableListening){state.readableListening=true;state.emittedReadable=false;state.needReadable=true;if(!state.reading){processNextTick(nReadingNextTick,this)}else if(state.length){emitReadable(this,state)}}}return res};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(self){debug("readable nexttick read 0");self.read(0)}Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug("resume");state.flowing=true;resume(this,state)}return this};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;processNextTick(resume_,stream,state)}}function resume_(stream,state){if(!state.reading){debug("resume read 0");stream.read(0)}state.resumeScheduled=false;stream.emit("resume");flow(stream);if(state.flowing&&!state.reading)stream.read(0)}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){debug("pause");this._readableState.flowing=false;this.emit("pause")}return this};function flow(stream){var state=stream._readableState;debug("flow",state.flowing);if(state.flowing){do{var chunk=stream.read()}while(null!==chunk&&state.flowing)}}Readable.prototype.wrap=function(stream){var state=this._readableState;var paused=false;var self=this;stream.on("end",function(){debug("wrapped end");if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)self.push(chunk)}self.push(null)});stream.on("data",function(chunk){debug("wrapped data");if(state.decoder)chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))return;else if(!state.objectMode&&(!chunk||!chunk.length))return;var ret=self.push(chunk);if(!ret){paused=true;stream.pause()}});for(var i in stream){if(this[i]===undefined&&typeof stream[i]==="function"){this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i)}}var events=["error","close","destroy","pause","resume"];forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))});self._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume()}};return self};Readable._fromList=fromList;function fromList(n,state){var list=state.buffer;var length=state.length;var stringMode=!!state.decoder;var objectMode=!!state.objectMode;var ret;if(list.length===0)return null;if(length===0)ret=null;else if(objectMode)ret=list.shift();else if(!n||n>=length){if(stringMode)ret=list.join("");else if(list.length===1)ret=list[0];else ret=Buffer.concat(list,length);list.length=0}else{if(n<list[0].length){var buf=list[0];ret=buf.slice(0,n);list[0]=buf.slice(n)}else if(n===list[0].length){ret=list.shift()}else{if(stringMode)ret="";else ret=bufferShim.allocUnsafe(n);var c=0;for(var i=0,l=list.length;i<l&&c<n;i++){var _buf=list[0];var cpy=Math.min(n-c,_buf.length);if(stringMode)ret+=_buf.slice(0,cpy);else _buf.copy(ret,c,0,cpy);if(cpy<_buf.length)list[0]=_buf.slice(cpy);else list.shift();c+=cpy}}}return ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');if(!state.endEmitted){state.ended=true;processNextTick(endReadableNT,state,stream)}}function endReadableNT(state,stream){if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit("end")}}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++){f(xs[i],i)}}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i}return-1}}).call(this,_dereq_("_process"))},{"./_stream_duplex":31,_process:26,buffer:16,"buffer-shims":15,"core-util-is":18,events:20,inherits:23,isarray:29,"process-nextick-args":25,"string_decoder/":44,util:14}],34:[function(_dereq_,module,exports){"use strict";module.exports=Transform;var Duplex=_dereq_("./_stream_duplex");var util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");util.inherits(Transform,Duplex);function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=false;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null;ts.writecb=null;if(data!==null&&data!==undefined)stream.push(data);cb(er);var rs=stream._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){stream._read(rs.highWaterMark)}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush}this.once("prefinish",function(){if(typeof this._flush==="function")this._flush(function(er){done(stream,er)});else done(stream)})}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("Not implemented")};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&ts.writecb&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else{ts.needTransform=true}};function done(stream,er){if(er)return stream.emit("error",er);var ws=stream._writableState;var ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}},{"./_stream_duplex":31,"core-util-is":18,inherits:23}],35:[function(_dereq_,module,exports){(function(process){"use strict";module.exports=Writable;var processNextTick=_dereq_("process-nextick-args");var asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;Writable.WritableState=WritableState;var util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");var internalUtil={deprecate:_dereq_("util-deprecate")};var Stream;(function(){try{Stream=_dereq_("st"+"ream")}catch(_){}finally{if(!Stream)Stream=_dereq_("events").EventEmitter}})();var Buffer=_dereq_("buffer").Buffer;var bufferShim=_dereq_("buffer-shims");util.inherits(Writable,Stream);function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null}var Duplex;function WritableState(options,stream){Duplex=Duplex||_dereq_("./_stream_duplex");options=options||{};this.objectMode=!!options.objectMode;if(stream instanceof Duplex)this.objectMode=this.objectMode||!!options.writableObjectMode;var hwm=options.highWaterMark;var defaultHwm=this.objectMode?16:16*1024;this.highWaterMark=hwm||hwm===0?hwm:defaultHwm;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function writableStateGetBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next}return out};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.")})}catch(_){}})();var Duplex;function Writable(options){Duplex=Duplex||_dereq_("./_stream_duplex");if(!(this instanceof Writable)&&!(this instanceof Duplex))return new Writable(options);this._writableState=new WritableState(options,this);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev}Stream.call(this)}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er);processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=true;var er=false;if(chunk===null){er=new TypeError("May not write null values to stream")}else if(!Buffer.isBuffer(chunk)&&typeof chunk!=="string"&&chunk!==undefined&&!state.objectMode){er=new TypeError("Invalid non-string/buffer chunk")}if(er){stream.emit("error",er);processNextTick(cb,er);valid=false}return valid}Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;if(typeof encoding==="function"){cb=encoding;encoding=null}if(Buffer.isBuffer(chunk))encoding="buffer";else if(!encoding)encoding=state.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state.ended)writeAfterEnd(this,cb);else if(validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,chunk,encoding,cb)}return ret};Writable.prototype.cork=function(){var state=this._writableState;state.corked++};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.finished&&!state.bufferProcessing&&state.bufferedRequest)clearBuffer(this,state)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);this._writableState.defaultEncoding=encoding;return this};function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==="string"){chunk=bufferShim.from(chunk,encoding)}return chunk}function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding);if(Buffer.isBuffer(chunk))encoding="buffer";var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)state.needDrain=true;if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest=new WriteReq(chunk,encoding,cb);if(last){last.next=state.lastBufferedRequest}else{state.bufferedRequest=state.lastBufferedRequest}state.bufferedRequestCount+=1}else{doWrite(stream,state,false,len,chunk,encoding,cb)}return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(writev)stream._writev(chunk,state.onwrite);else stream._write(chunk,encoding,state.onwrite);state.sync=false}function onwriteError(stream,state,sync,er,cb){--state.pendingcb;if(sync)processNextTick(cb,er);else cb(er);stream._writableState.errorEmitted=true;stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0}function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;onwriteStateUpdate(state);if(er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);if(!finished&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest){clearBuffer(stream,state)}if(sync){asyncWrite(afterWrite,stream,state,finished,cb)}else{afterWrite(stream,state,finished,cb)}}}function afterWrite(stream,state,finished,cb){if(!finished)onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state)}function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state){state.bufferProcessing=true;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount;var buffer=new Array(l);var holder=state.corkedRequestsFree;holder.entry=entry;var count=0;while(entry){buffer[count]=entry;entry=entry.next;count+=1}doWrite(stream,state,true,state.length,buffer,"",holder.finish);state.pendingcb++;state.lastBufferedRequest=null;if(holder.next){state.corkedRequestsFree=holder.next;holder.next=null}else{state.corkedRequestsFree=new CorkedRequest(state)}}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);entry=entry.next;if(state.writing){break}}if(entry===null)state.lastBufferedRequest=null}state.bufferedRequestCount=0;state.bufferedRequest=entry;state.bufferProcessing=false}Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("not implemented"))};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(chunk!==null&&chunk!==undefined)this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork()}if(!state.ending&&!state.finished)endWritable(this,state,cb)};function needFinish(state){return state.ending&&state.length===0&&state.bufferedRequest===null&&!state.finished&&!state.writing}function prefinish(stream,state){if(!state.prefinished){state.prefinished=true;stream.emit("prefinish")}}function finishMaybe(stream,state){var need=needFinish(state);if(need){if(state.pendingcb===0){prefinish(stream,state);state.finished=true;stream.emit("finish")}else{prefinish(stream,state)}}return need}function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)processNextTick(cb);else stream.once("finish",cb)}state.ended=true;stream.writable=false}function CorkedRequest(state){var _this=this;this.next=null;this.entry=null;this.finish=function(err){var entry=_this.entry;_this.entry=null;while(entry){var cb=entry.callback;state.pendingcb--;cb(err);entry=entry.next}if(state.corkedRequestsFree){state.corkedRequestsFree.next=_this}else{state.corkedRequestsFree=_this}}}}).call(this,_dereq_("_process"))},{"./_stream_duplex":31,_process:26,buffer:16,"buffer-shims":15,"core-util-is":18,events:20,inherits:23,"process-nextick-args":25,"util-deprecate":45}],36:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":32}],37:[function(_dereq_,module,exports){(function(process){var Stream=function(){try{return _dereq_("st"+"ream")}catch(_){}}();exports=module.exports=_dereq_("./lib/_stream_readable.js");exports.Stream=Stream||exports;exports.Readable=exports;exports.Writable=_dereq_("./lib/_stream_writable.js");exports.Duplex=_dereq_("./lib/_stream_duplex.js");exports.Transform=_dereq_("./lib/_stream_transform.js");exports.PassThrough=_dereq_("./lib/_stream_passthrough.js");if(!process.browser&&process.env.READABLE_STREAM==="disable"&&Stream){module.exports=Stream}}).call(this,_dereq_("_process"))},{"./lib/_stream_duplex.js":31,"./lib/_stream_passthrough.js":32,"./lib/_stream_readable.js":33,"./lib/_stream_transform.js":34,"./lib/_stream_writable.js":35,_process:26}],38:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":34}],39:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":35}],40:[function(_dereq_,module,exports){"use strict";module.exports={DEFAULT_INITIAL_SIZE:8*1024,DEFAULT_INCREMENT_AMOUNT:8*1024,DEFAULT_FREQUENCY:1,DEFAULT_CHUNK_SIZE:1024}},{}],41:[function(_dereq_,module,exports){(function(Buffer){"use strict";var stream=_dereq_("stream");var constants=_dereq_("./constants");var util=_dereq_("util");var ReadableStreamBuffer=module.exports=function(opts){var that=this;opts=opts||{};stream.Readable.call(this,opts);this.stopped=false;var frequency=opts.hasOwnProperty("frequency")?opts.frequency:constants.DEFAULT_FREQUENCY;var chunkSize=opts.chunkSize||constants.DEFAULT_CHUNK_SIZE;var initialSize=opts.initialSize||constants.DEFAULT_INITIAL_SIZE;var incrementAmount=opts.incrementAmount||constants.DEFAULT_INCREMENT_AMOUNT;var size=0;var buffer=new Buffer(initialSize);var sendData=function(){var amount=Math.min(chunkSize,size);var sendMore=false;if(amount>0){var chunk=null;chunk=new Buffer(amount);buffer.copy(chunk,0,0,amount);sendMore=that.push(chunk);buffer.copy(buffer,0,amount,size);size-=amount}if(size===0&&that.stopped){that.push(null)}if(sendMore){sendData.timeout=setTimeout(sendData,frequency)}};this.stop=function(){if(this.stopped){throw new Error("stop() called on already stopped ReadableStreamBuffer")}this.stopped=true;if(size===0){this.push(null)}};this.size=function(){return size};this.maxSize=function(){return buffer.length};var increaseBufferIfNecessary=function(incomingDataSize){if(buffer.length-size<incomingDataSize){var factor=Math.ceil((incomingDataSize-(buffer.length-size))/incrementAmount);var newBuffer=new Buffer(buffer.length+incrementAmount*factor);buffer.copy(newBuffer,0,0,size);buffer=newBuffer}};this.put=function(data,encoding){if(that.stopped){throw new Error("Tried to write data to a stopped ReadableStreamBuffer")}if(Buffer.isBuffer(data)){increaseBufferIfNecessary(data.length);data.copy(buffer,size,0);size+=data.length}else{data=data+"";var dataSizeInBytes=Buffer.byteLength(data);increaseBufferIfNecessary(dataSizeInBytes);buffer.write(data,size,encoding||"utf8");size+=dataSizeInBytes}};this._read=function(){if(!sendData.timeout){sendData.timeout=setTimeout(sendData,frequency)}}};util.inherits(ReadableStreamBuffer,stream.Readable)}).call(this,_dereq_("buffer").Buffer)},{"./constants":40,buffer:16,stream:28,util:47}],42:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./constants");module.exports.ReadableStreamBuffer=_dereq_("./readable_streambuffer");module.exports.WritableStreamBuffer=_dereq_("./writable_streambuffer")},{"./constants":40,"./readable_streambuffer":41,"./writable_streambuffer":43}],43:[function(_dereq_,module,exports){(function(Buffer){"use strict";var util=_dereq_("util");var stream=_dereq_("stream");var constants=_dereq_("./constants");var WritableStreamBuffer=module.exports=function(opts){opts=opts||{};opts.decodeStrings=true;stream.Writable.call(this,opts);var initialSize=opts.initialSize||constants.DEFAULT_INITIAL_SIZE;var incrementAmount=opts.incrementAmount||constants.DEFAULT_INCREMENT_AMOUNT;var buffer=new Buffer(initialSize);var size=0;this.size=function(){return size};this.maxSize=function(){return buffer.length};this.getContents=function(length){if(!size)return false;var data=new Buffer(Math.min(length||size,size));buffer.copy(data,0,0,data.length);if(data.length<size)buffer.copy(buffer,0,data.length);size-=data.length;return data};this.getContentsAsString=function(encoding,length){if(!size)return false;var data=buffer.toString(encoding||"utf8",0,Math.min(length||size,size));var dataLength=Buffer.byteLength(data);if(dataLength<size)buffer.copy(buffer,0,dataLength);size-=dataLength;return data};var increaseBufferIfNecessary=function(incomingDataSize){if(buffer.length-size<incomingDataSize){var factor=Math.ceil((incomingDataSize-(buffer.length-size))/incrementAmount);var newBuffer=new Buffer(buffer.length+incrementAmount*factor);buffer.copy(newBuffer,0,0,size);buffer=newBuffer}};this._write=function(chunk,encoding,callback){increaseBufferIfNecessary(chunk.length);chunk.copy(buffer,size,0);size+=chunk.length;callback()}};util.inherits(WritableStreamBuffer,stream.Writable)}).call(this,_dereq_("buffer").Buffer)},{"./constants":40,buffer:16,stream:28,util:47}],44:[function(_dereq_,module,exports){var Buffer=_dereq_("buffer").Buffer;var isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding)){throw new Error("Unknown encoding: "+encoding)}}var StringDecoder=exports.StringDecoder=function(encoding){this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,"");assertEncoding(encoding);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=base64DetectIncompleteChar;break;default:this.write=passThroughWrite;return}this.charBuffer=new Buffer(6);this.charReceived=0;this.charLength=0};StringDecoder.prototype.write=function(buffer){var charStr="";while(this.charLength){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;buffer.copy(this.charBuffer,this.charReceived,0,available);this.charReceived+=available;if(this.charReceived<this.charLength){return""}buffer=buffer.slice(available,buffer.length);charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(charCode>=55296&&charCode<=56319){this.charLength+=this.surrogateSize;charStr="";continue}this.charReceived=this.charLength=0;if(buffer.length===0){return charStr}break}this.detectIncompleteChar(buffer);var end=buffer.length;if(this.charLength){buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end);end-=this.charReceived}charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1;var charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;this.charLength+=size;this.charReceived+=size;this.charBuffer.copy(this.charBuffer,size,0,size);buffer.copy(this.charBuffer,0,0,size);return charStr.substring(0,end)}return charStr};StringDecoder.prototype.detectIncompleteChar=function(buffer){var i=buffer.length>=3?3:buffer.length;for(;i>0;i--){var c=buffer[buffer.length-i];if(i==1&&c>>5==6){this.charLength=2;break}if(i<=2&&c>>4==14){this.charLength=3;break}if(i<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i};StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length)res=this.write(buffer);if(this.charReceived){var cr=this.charReceived;var buf=this.charBuffer;var enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res};function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2;this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3;this.charLength=this.charReceived?3:0}},{buffer:16}],45:[function(_dereq_,module,exports){(function(global){module.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg)}else if(config("traceDeprecation")){console.trace(msg)}else{console.warn(msg)}warned=true}return fn.apply(this,arguments)}return deprecated}function config(name){try{if(!global.localStorage)return false}catch(_){return false}var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==="true"}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],46:[function(_dereq_,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},{}],47:[function(_dereq_,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}});for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(isUndefined(global.process)){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}if(process.noDeprecation===true){return fn}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set]){if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach(function(val,idx){hash[val]=true});return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach(function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}});return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2)}else{str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name");
}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce(function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=_dereq_("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=_dereq_("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}).call(this,_dereq_("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":46,_process:26,inherits:23}],48:[function(_dereq_,module,exports){_dereq_("dataview-getstring");function VoiceData(data){this.modulatorTremolo=data.getUint8(0);this.modulatorAttack=data.getUint8(1);this.modulatorSustain=data.getUint8(2);this.modulatorWaveform=data.getUint8(3);this.modulatorKey=data.getUint8(4);this.modulatorOutput=data.getUint8(5);this.feedback=data.getUint8(6);this.carrierTremolo=data.getUint8(7);this.carrierAttack=data.getUint8(8);this.carrierSustain=data.getUint8(9);this.carrierWaveform=data.getUint8(10);this.carrierKey=data.getUint8(11);this.carrierOutput=data.getUint8(12);this.baseNoteOffset=data.getInt16(14,true)}function OPLInstrument(name,data){this.name=name;this.data=data;this.flags=data.getUint16(0,true);this.fixedPitch=!!(this.flags&1);this.unknown=!!(this.flags&2);this.doubleVoice=!!(this.flags&4);this.fineTuning=data.getUint8(2);this.fixedNote=data.getUint8(3);this.voices=[new VoiceData(new DataView(data.buffer.slice(4,20))),new VoiceData(new DataView(data.buffer.slice(20,36)))]}function GENMIDI(lump){lump=lump instanceof DataView?lump:new DataView(lump.buffer||lump);this.header=lump.getString(0,8);this.instruments=[];for(var i=8,j=175*36+8;i<175*36+8;i+=36,j+=32){var name=lump.getString(j);this.instruments.push(new OPLInstrument(name,new DataView(lump.buffer.slice(i,i+36))))}this.lump=lump}module.exports=GENMIDI},{"dataview-getstring":19}]},{},[7])(7)});
